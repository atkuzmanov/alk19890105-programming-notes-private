(function($){$(function(){$('#subscribeForm').on('submit',function(e){e.preventDefault();var frm=$(this);var email=frm.find('[name="email"]').val();if(email==undefined||!email.length){frm.find('span.error').html('Email is required!').show();}else if(!validateEmail(email)){frm.find('span.error').html('Wrong Email!').show();}else{frm.find('span.error').hide();grecaptcha.execute(window.reCaptchaV3SiteKey,{action:'subscribe_form'}).then(function(token){$.post('/wp-admin/admin-ajax.php','action=recaptcha_validation&captcha_action=subscribe_form&token='+token).done(function(response){if(response.result){$.post('/wp-admin/admin-ajax.php','action=mailchimp_subscription&email='+email).done(function(response){if(response.error||!response.result){frm.find('span.error').html('Subscribe error').show();console.error('Subscribe error:');console.error(response.error?response.errorMessage:response.message);$(document).find('#subscribeError').show();}else{frm.find('[name="email"]').val('');frm.find('span.success').html('Successfully subscribed!');$(document).find('#subscribeError').hide();$(document).find('#subscribeSuccess').show();}}).fail(function(xhr){console.error('Subscribe error:');console.error(xhr.responseMessage);$(document).find('#subscribeError').show();});}});});}});})})(jQuery);function validateEmail(email){var re=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email);}