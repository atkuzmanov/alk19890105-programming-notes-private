<!DOCTYPE html>
<!-- saved from url=(0105)https://www.javacodemonk.com/what-is-n-1-problem-in-hibernate-how-will-you-identify-and-solve-it-894097b9 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script type="text/javascript" async="" src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/analytics.js"></script><script async="" src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/js"></script>
      <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());
          gtag('config', 'UA-138181587-2');
      </script>
  
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="N+1 problem is a performance issue in Object Relational Mapping that fires multiple Select Queries in database for a single select query at application layer. Hibernate provides multiple ways to identify and prevent this problem.">
      <meta name="keywords" content="N+1 problem SQL">
  <meta name="author" content="Carvia Tech">
<meta name="_csrf_parameter" content="_csrf"><meta name="_csrf_header" content="X-CSRF-TOKEN"><meta name="_csrf" content="317852b5-b3bc-4fbc-b0bd-40e070d1aa7e">  <link rel="shortcut icon" href="https://www.javacodemonk.com/favicon.ico" type="image/x-icon">
  <link rel="icon" href="https://www.javacodemonk.com/favicon.ico" type="image/x-icon">
  <link rel="canonical" href="https://www.javacodemonk.com/what-is-n-1-problem-in-hibernate-how-will-you-identify-and-solve-it-894097b9">

  <title>What is N+1 problem in Hibernate, how will you identify and solve it?</title>

  <link rel="stylesheet" href="./What is N+1 problem in Hibernate, how will you identify and solve it__files/css">
  <!-- Bootstrap Core CSS -->
  <link href="./What is N+1 problem in Hibernate, how will you identify and solve it__files/bootstrap.min-9789b96f44004a593f70a170ff563e16.css" rel="stylesheet">
  <link href="./What is N+1 problem in Hibernate, how will you identify and solve it__files/jumbotron-0ef7edc6babea5a47645bda0c45368aa.css" rel="stylesheet">
  <link href="./What is N+1 problem in Hibernate, how will you identify and solve it__files/blog-home-ade407501ff5c1ab784618eb657e923e.css" rel="stylesheet">
  <link href="./What is N+1 problem in Hibernate, how will you identify and solve it__files/asciidoctor-custom-72ee2fb2e0424bba9d48534f9144e7d1.css" rel="stylesheet">
<link href="./What is N+1 problem in Hibernate, how will you identify and solve it__files/cookie-bar-style-da77a131b3831e3c347356792e63eb6f.css" rel="stylesheet">
<link href="./What is N+1 problem in Hibernate, how will you identify and solve it__files/font-awesome.min-269550530cc127b6aa5a35925a7de6ce.css" rel="stylesheet">

  <link href="./What is N+1 problem in Hibernate, how will you identify and solve it__files/font-awesome.min-269550530cc127b6aa5a35925a7de6ce.css" rel="stylesheet">

  <meta property="og:url" content="https://www.javacodemonk.com/what-is-n-1-problem-in-hibernate-how-will-you-identify-and-solve-it-894097b9">
  <meta property="og:type" content="article">
  <meta property="og:title" content="What is N+1 problem in Hibernate, how will you identify and solve it?">
  <meta property="og:description" content="N+1 problem is a performance issue in Object Relational Mapping that fires multiple Select Queries in database for a single select query at application layer. Hibernate provides multiple ways to identify and prevent this problem.">

  <script src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/jquery.min.js"></script>

   <link href="./What is N+1 problem in Hibernate, how will you identify and solve it__files/xcode-ed99a3ac6aad0509c8425eecc7710950.css" rel="stylesheet">

  <script type="application/ld+json">
  {
      "@context": "http://schema.org",
      "@type": "BlogPosting",
      "headline": "What is N+1 problem in Hibernate, how will you identify and solve it?",
      "image": "https://s3.shunyafoundation.com/s3/8aa689f74939763c8629983741283fbef0538d57/spring-2x-1.png",
      "keywords": "N+1 problem SQL",
      "description": "N+1 problem is a performance issue in Object Relational Mapping that fires multiple Select Queries in database for a single select query at application layer. Hibernate provides multiple ways to identify and prevent this problem.",
      "publisher": {
            "@type": "Organization",
            "name": "Carvia Tech"
      },
      "url": "https://www.javacodemonk.com/what-is-n-1-problem-in-hibernate-how-will-you-identify-and-solve-it-894097b9",
      "datePublished": "2017-12-23",
      "dateModified": "2017-12-23",
      "author": {
          "@type": "Person",
          "name": "Carvia Tech"
      }
  }
  </script>

  <script type="text/javascript">
      $(function () {
          var token = $("meta[name='_csrf']").attr("content");
          var header = $("meta[name='_csrf_header']").attr("content");
          $(document).ajaxSend(function (e, xhr, options) {
              xhr.setRequestHeader(header, token);
          });
      });

      var scrollToElement = function (el, ms) {
          var speed = (ms) ? ms : 1500;
          $('html,body').animate({
              scrollTop: $(el).offset().top
          }, speed);
      };

      var useAjaxBusyWait = function () {
          $(document).ready(function () {
              $('body').append('<div id="ajaxBusy"><p id="ajaxBusyMsg">Please wait...</p></div>');
              // AJAX activity indicator bound to ajax start/stop document events
              $(document).ajaxStart(function () {
                  $('#ajaxBusy').show();
              }).ajaxStop(function () {
                  $('#ajaxBusy').hide();
              });
          });
      };
  </script>



  <style>
    h1, .h1 {
      font-size: 2.0rem;
    }

    .sticky-top { top: 5.5em; }
  </style>
</head>

<body>

<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-primary">
    <div class="container">
    <a class="navbar-brand" href="https://www.javacodemonk.com/"><i class="fa fa-home" aria-hidden="true"></i> CodeMonk</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarCollapse">
        <ul class="navbar-nav mr-auto">
            <li id="ml_menu_id" class="nav-item">
                <a class="nav-link" href="https://www.javacodemonk.com/category/machine-learning">ML</a>
            </li>
            <li id="sdet_menu_id" class="nav-item">
                <a class="nav-link" href="https://www.javacodemonk.com/category/sdet-interviews">SDET</a>
            </li>
            <li id="java_menu_id" class="nav-item">
                <a class="nav-link" href="https://www.javacodemonk.com/category/java-interviews">Java</a>
            </li>
            <li id="microservices_menu_id" class="nav-item">
                <a class="nav-link" href="https://www.javacodemonk.com/category/microservices">Microservices</a>
            </li>
            <li id="spring_menu_id" class="nav-item">
                <a class="nav-link" href="https://www.javacodemonk.com/category/spring-framework">Spring</a>
            </li>
            <li id="explore_id" class="nav-item">
                <a class="nav-link" href="https://www.javacodemonk.com/explore"><i class="fa fa-list" aria-hidden="true"></i> More</a>
            </li>
            <li id="bookshelf_id" class="nav-item">
                <a class="nav-link" href="https://www.javacodemonk.com/book-shelf"><i class="fa fa-book" aria-hidden="true"></i> Book Shelf</a>
            </li>



        </ul>

        <form class="form-inline my-2 my-lg-0" action="https://www.javacodemonk.com/search" method="get">
            <input class="form-control mr-sm-1" type="text" value="" name="q" placeholder="Search for ..." required="">
            <button class="btn btn-secondary my-2 my-sm-0" type="submit"><i class="fa fa-search" aria-hidden="true"></i></button>
        </form>

    </div>
    </div>
</nav>

<script>
    $('#home_id').addClass('active');
</script>

<main role="main">
    <!-- Page Content -->
    <div class="container mt-3">

        <div class="row">
            <!-- Post Content Column -->
            <div class="col-lg-8 col-md-8 col-sm-12">
                <nav aria-label="breadcrumb" role="navigation">
                    <ol class="breadcrumb small">
                        <li class="breadcrumb-item"><a href="https://www.javacodemonk.com/explore">Home</a></li>
                            <li class="breadcrumb-item"><a href="https://www.javacodemonk.com/category/spring-framework">Spring Framework</a></li>
                            <li class="breadcrumb-item"><a href="https://www.javacodemonk.com/category/spring-hibernate">Spring Hibernate</a></li>
                        <li class="breadcrumb-item active" aria-current="page">What is N+1 problem in Hibernate, how will you identify and solve it?</li>
                    </ol>
                </nav>

                <!-- Title -->
                <h1 class="mt-3">What is N+1 problem in Hibernate, how will you identify and solve it?</h1>

                <p class="lead small">
                    <span class="mr-2"><i class="fa fa-address-card-o" aria-hidden="true"></i> Carvia Tech</span> |
                    <span class="text-muted1 ml-2 mr-2"><i class="fa fa-calendar" aria-hidden="true"></i> December 23, 2017</span> |
                    <span class="text-muted1 ml-2 mr-2"><i class="fa fa-clock-o" aria-hidden="true"></i> 4 min read</span> |
                    <span class="text-muted1 ml-2 mr-2"><i class="fa fa-eye" aria-hidden="true"></i> 4,226 views</span>
                </p>

                <hr>


                <!-- Post Content -->
                <div class="customCss">
                    <div class="paragraph">
<p>N+1 problem is a performance issue in Object Relational Mapping that fires multiple select queries (N+1 to be exact, where N= number of records in table) in database for a single select query at application layer. Hibernate provides multiple ways to catch and prevent this problem.</p>
</div>
<div class="sect1">
<h2 id="_what_is_n_1_problem">What is N+1 Problem?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To understand N+1 problem, lets consider a scenario. Let’s say we have a collection of <code>User</code> objects mapped to <code>t_users</code> table in database, and each user has collection or <code>Role</code> mapped to <code>t_roles</code> table using a joining table <code>t_user_roles</code>. At the ORM level a <code>User</code> has many to many relationship with <code>Role</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java"><span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table</span>(name = <span class="hljs-string">"t_users"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> </span>{

    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue</span>(strategy=GenerationType.AUTO)
    <span class="hljs-keyword">private</span> Long id;
    <span class="hljs-keyword">private</span> String name;

    <span class="hljs-meta">@ManyToMany</span>(fetch = FetchType.LAZY)                    <i class="conum" data-value="1"></i><b>(<span class="hljs-number">1</span>)</b>
    <span class="hljs-keyword">private</span> Set&lt;Role&gt; roles;
    <span class="hljs-comment">//Getter and Setters removed for brevity</span>
 }

<span class="hljs-meta">@Entity</span>
<span class="hljs-meta">@Table</span>(name = <span class="hljs-string">"t_roles"</span>)
<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Role</span> </span>{

    <span class="hljs-meta">@Id</span>
    <span class="hljs-meta">@GeneratedValue</span>(strategy= GenerationType.AUTO)
    <span class="hljs-keyword">private</span> Long id;

    <span class="hljs-keyword">private</span> String name;
    <span class="hljs-comment">//Getter and Setters removed for brevity</span>
 }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>A user can have many roles.</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Now lets say we want to fetch all users from this table and print roles for each one. Very naive Object Relational implementation could be -</p>
</div>
<div class="paragraph">
<p>First Get All User</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Select * from t_users;</pre>
</div>
</div>
<div class="paragraph">
<p>Then get roles for each user</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Select * from t_user_roles where userid = &lt;userid&gt;;</pre>
</div>
</div>
<div class="paragraph">
<p>So we need one select for User and N additional selects for fetching roles for each user, where N is total number of users. This is a classic N+1 problem in ORM.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_how_to_identify_it">How to identify it?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hibernate provide tracing option that enables SQL logging in the console/logs. using logs you can easily see if hibernate is issuing N+1 queries for a given call.</p>
</div>
<div class="listingblock">
<div class="title">Enabling SQL logging in application.yml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml"><span class="hljs-attr">spring:</span>
<span class="hljs-attr">    jpa:</span>
<span class="hljs-attr">       show-sql:</span> <span class="hljs-literal">true</span>             <i class="conum" data-value="1"></i><b><span class="hljs-string">(1)</span></b>
<span class="hljs-attr">       database-platform:</span> <span class="hljs-string">org.hibernate.dialect.H2Dialect</span>
<span class="hljs-attr">       hibernate:</span>
<span class="hljs-attr">         ddl-auto:</span> <span class="hljs-string">create</span>
<span class="hljs-attr">         use-new-id-generator-mappings:</span> <span class="hljs-literal">true</span>
<span class="hljs-attr">       properties:</span>
<span class="hljs-attr">          hibernate:</span>
<span class="hljs-attr">            type:</span> <span class="hljs-string">trace</span>            <i class="conum" data-value="2"></i><b><span class="hljs-string">(2)</span></b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Enables SQL logging in trace.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>We have to enable this too in order to show sql queries in logs.</td>
</tr>
</tbody></table>
</div>
<div class="listingblock">
<div class="title">Typical N+1 SQL logs printed in logs</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">2017-12-23 07:42:30.923  INFO 11657 <span class="hljs-comment">--- [           main] hello.UserService                        : Customers found with findAll():</span>
Hibernate: <span class="hljs-keyword">select</span> user0_.id <span class="hljs-keyword">as</span> id1_1_, user0_.name <span class="hljs-keyword">as</span> name2_1_ <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> user0_
Hibernate: <span class="hljs-keyword">select</span> roles0_.user_id <span class="hljs-keyword">as</span> user_id1_2_0_, roles0_.roles_id <span class="hljs-keyword">as</span> roles_id2_2_0_, role1_.id <span class="hljs-keyword">as</span> id1_0_1_, role1_.name <span class="hljs-keyword">as</span> name2_0_1_ <span class="hljs-keyword">from</span> user_roles roles0_ <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> <span class="hljs-keyword">role</span> role1_ <span class="hljs-keyword">on</span> roles0_.roles_id=role1_.id <span class="hljs-keyword">where</span> roles0_.user_id=?
Hibernate: <span class="hljs-keyword">select</span> roles0_.user_id <span class="hljs-keyword">as</span> user_id1_2_0_, roles0_.roles_id <span class="hljs-keyword">as</span> roles_id2_2_0_, role1_.id <span class="hljs-keyword">as</span> id1_0_1_, role1_.name <span class="hljs-keyword">as</span> name2_0_1_ <span class="hljs-keyword">from</span> user_roles roles0_ <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> <span class="hljs-keyword">role</span> role1_ <span class="hljs-keyword">on</span> roles0_.roles_id=role1_.id <span class="hljs-keyword">where</span> roles0_.user_id=?
Hibernate: <span class="hljs-keyword">select</span> roles0_.user_id <span class="hljs-keyword">as</span> user_id1_2_0_, roles0_.roles_id <span class="hljs-keyword">as</span> roles_id2_2_0_, role1_.id <span class="hljs-keyword">as</span> id1_0_1_, role1_.name <span class="hljs-keyword">as</span> name2_0_1_ <span class="hljs-keyword">from</span> user_roles roles0_ <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> <span class="hljs-keyword">role</span> role1_ <span class="hljs-keyword">on</span> roles0_.roles_id=role1_.id <span class="hljs-keyword">where</span> roles0_.user_id=?
Hibernate: <span class="hljs-keyword">select</span> roles0_.user_id <span class="hljs-keyword">as</span> user_id1_2_0_, roles0_.roles_id <span class="hljs-keyword">as</span> roles_id2_2_0_, role1_.id <span class="hljs-keyword">as</span> id1_0_1_, role1_.name <span class="hljs-keyword">as</span> name2_0_1_ <span class="hljs-keyword">from</span> user_roles roles0_ <span class="hljs-keyword">inner</span> <span class="hljs-keyword">join</span> <span class="hljs-keyword">role</span> role1_ <span class="hljs-keyword">on</span> roles0_.roles_id=role1_.id <span class="hljs-keyword">where</span> roles0_.user_id=?</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you see multiple entries for SQL for a given select query, then there are high chances that its due to N+1 problem.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_n_1_resolution">N+1 Resolution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Hibernate &amp; spring Data provide mechanism to solve the N+1 ORM issue.</p>
</div>
<div class="paragraph">
<p>at SQL level, what ORM needs to achieve to avoid N+1 is to fire a query that joins the two tables and get the combined results in single query.</p>
</div>
<div class="listingblock">
<div class="title">Fetch Join SQL that retrieves everything (user and roles) in Single Query</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-sql hljs" data-lang="sql">Hibernate: <span class="hljs-keyword">select</span> user0_.id <span class="hljs-keyword">as</span> id1_1_0_, role2_.id <span class="hljs-keyword">as</span> id1_0_1_, user0_.name <span class="hljs-keyword">as</span> name2_1_0_, role2_.name <span class="hljs-keyword">as</span> name2_0_1_, roles1_.user_id <span class="hljs-keyword">as</span> user_id1_2_0__, roles1_.roles_id <span class="hljs-keyword">as</span> roles_id2_2_0__ <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> user0_ <span class="hljs-keyword">left</span> <span class="hljs-keyword">outer</span> <span class="hljs-keyword">join</span> user_roles roles1_ <span class="hljs-keyword">on</span> user0_.id=roles1_.user_id <span class="hljs-keyword">left</span> <span class="hljs-keyword">outer</span> <span class="hljs-keyword">join</span> <span class="hljs-keyword">role</span> role2_ <span class="hljs-keyword">on</span> roles1_.roles_id=role2_.id</code></pre>
</div>
</div>
<div class="literalblock">
<div class="title">OR Plain SQL</div>
<div class="content">
<pre>select user0_.id, role2_.id, user0_.name, role2_.name, roles1_.user_id, roles1_.roles_id from user user0_ left outer join user_roles roles1_ on user0_.id=roles1_.user_id left outer join role role2_ on roles1_.roles_id=role2_.id</pre>
</div>
</div>
<div class="sect2">
<h3 id="_spring_data_jpa_approach">Spring Data JPA Approach</h3>
<div class="paragraph">
<p>If we are using Spring Data JPA, then we have two options to achieve this - using EntityGraph or using select query with fetch join.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java"><span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">interface</span> <span class="hljs-title">UserRepository</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">CrudRepository</span>&lt;<span class="hljs-title">User</span>, <span class="hljs-title">Long</span>&gt; </span>{

    <span class="hljs-function">List&lt;User&gt; <span class="hljs-title">findAllByRolesIn</span><span class="hljs-params">(List&lt;Role&gt; roles)</span></span>;             <i class="conum" data-value="1"></i><b>(<span class="hljs-number">1</span>)</b>

    <span class="hljs-meta">@Query</span>(<span class="hljs-string">"SELECT p FROM User p LEFT JOIN FETCH p.roles"</span>)  <i class="conum" data-value="2"></i><b>(<span class="hljs-number">2</span>)</b>
    <span class="hljs-function">List&lt;User&gt; <span class="hljs-title">findWithoutNPlusOne</span><span class="hljs-params">()</span></span>;

    <span class="hljs-meta">@EntityGraph</span>(attributePaths = {<span class="hljs-string">"roles"</span>})                      <i class="conum" data-value="3"></i><b>(<span class="hljs-number">3</span>)</b>
    <span class="hljs-function">List&lt;User&gt; <span class="hljs-title">findAll</span><span class="hljs-params">()</span></span>;
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tbody><tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>N+1 queries are issued at database level.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>using left join fetch, we resolve the N+1 problem</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>using attributePaths, Spring Data JPA avoids N+1 problem</td>
</tr>
</tbody></table>
</div>
</div>
<div class="sect2">
<h3 id="_hibernate_aproach">Hibernate Aproach</h3>
<div class="paragraph">
<p>if its pure Hibernate, then the following solution will work.</p>
</div>
<div class="literalblock">
<div class="title">HQL Query</div>
<div class="content">
<pre>"from User u join fetch u.roles roles roles"</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Hibernate Criteria API</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Criteria criteria = session.createCriteria(User.class);
criteria.setFetchMode(<span class="hljs-string">"roles"</span>, FetchMode.EAGER);</code></pre>
</div>
</div>
<div class="paragraph">
<p>under the hood, all these approaches work similar and they issue a similar database query with <code>left join fetch</code></p>
</div>
<div class="paragraph">
<p>That’s all!</p>
</div>
</div>
</div>
</div>
                </div>

    <script async="" src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/f.txt"></script>
    <ins class="adsbygoogle" style="display:block; text-align:center;" data-ad-layout="in-article" data-ad-format="fluid" data-ad-client="ca-pub-8459438937301460" data-ad-slot="7685550227">
    </ins>
    <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
    </script>


                    <hr class="hr-line-dashed">

                    <h6 class="text-muted">Top articles in this category:</h6>
                    <ol>
                            <li><a href="https://www.javacodemonk.com/handle-unresolved-circular-dependency-in-spring-core-cd11b997">How will you handle unresolved circular dependency in spring dependency injection?</a></li>
                            <li><a href="https://www.javacodemonk.com/prevent-lost-updates-in-database-transaction-using-spring-hibernate-f16d36d5">Prevent Lost Updates in Database Transaction using Spring Hibernate</a></li>
                            <li><a href="https://www.javacodemonk.com/how-to-implement-thread-safe-table-backed-global-counter-in-spring-hibernate-bf6ed4c8">How to implement thread safe table backed global counter in spring hibernate?</a></li>
                            <li><a href="https://www.javacodemonk.com/custom-banner-in-spring-boot-93a85044">Custom banner in spring boot</a></li>
                            <li><a href="https://www.javacodemonk.com/how-does-session-handling-works-in-servlet-environment-0b439561">How does Session handling works in Servlet environment</a></li>
                            <li><a href="https://www.javacodemonk.com/what-are-inheritance-mapping-strategies-in-jpa-5ef46a30">What are inheritance mapping strategies in JPA</a></li>
                            <li><a href="https://www.javacodemonk.com/java-8-date-time-json-formatting-with-jackson-5fe5ff13">Java 8 date time JSON formatting with Jackson</a></li>
                    </ol>

                <hr class="hr-line-dashed">

                <div class="text-left">
                    <h6 class="text-muted mb-3">Share article:</h6>
                    <a class="btn btn-sm btn-outline-info" href="https://www.facebook.com/sharer/sharer.php?u=https://www.javacodemonk.com/what-is-n-1-problem-in-hibernate-how-will-you-identify-and-solve-it-894097b9" target="_blank">
                        <i class="fa fa-facebook-official" aria-hidden="true"></i> Facebook
                    </a>
                    <a class="btn btn-sm btn-outline-info" href="https://twitter.com/intent/tweet?text=https://www.javacodemonk.com/what-is-n-1-problem-in-hibernate-how-will-you-identify-and-solve-it-894097b9" target="_blank">
                        <i class="fa fa-twitter" aria-hidden="true"></i> Twitter
                    </a>
                    <a class="btn btn-sm btn-outline-info" href="https://www.linkedin.com/cws/share?url=https://www.javacodemonk.com/what-is-n-1-problem-in-hibernate-how-will-you-identify-and-solve-it-894097b9&amp;title=What%20is%20N+1%20problem%20in%20Hibernate,%20how%20will%20you%20identify%20and%20solve%20it?" target="_blank">
                        <i class="fa fa-linkedin-square" aria-hidden="true"></i> LinkedIn
                    </a>
                </div>

                <br>


                <h6 class="text-muted">Find more on this topic:</h6>

                <a href="https://www.javacodemonk.com/category/spring-framework" class="card-link">
                <div class="card mb-3 shadow-sm h-md-250" style="max-width: 540px;">
                    <div class="row no-gutters">
                        <div class="col-md-4">
                            <img src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/spring-2x-1.png" class="card-img" alt="Spring Framework image">
                        </div>
                        <div class="col-md-8">
                            <div class="card-body">
                                <h5 class="card-title">Spring Framework</h5>
                                <p class="card-text">Spring Framework - MVC, Dependency Injection, Spring Hibernate, Spring Data JPA, Spring Boot and Spring Cloud for Microservices Architecture.</p>
                                <p class="card-text"><small class="text-muted">Last updated 1 week ago</small></p>
                            </div>
                        </div>
                    </div>
                </div>
                </a>

                <br>

                    <h6 class="text-muted">Recommended books for interview preparation:</h6>
    <div class="row">
        <div class="col-md-6">
            <div class="card bg-light mb-3">
                <div class="card-header">
                    Book you may be interested in..
                </div>
                <div class="card-body">
                    <div class="media">
                        <a href="https://books.shunyafoundation.com/to/VWVTPZ3A?affid=javablog" target="_blank">
                            <img class="mr-3 img-responsive" style="max-height: 170px;" src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/spring-microservices-interviews-small.jpg" alt="Generic placeholder image">
                        </a>
                        <div class="media-body">
                            <h5 class="card-title mt-0"><a href="https://books.shunyafoundation.com/to/VWVTPZ3A?affid=javablog" target="_blank">ebook PDF - Cracking Spring Microservices Interviews for Java Developers</a></h5>
                            <nav>
                                <a href="https://books.shunyafoundation.com/to/VWVTPZ3A?affid=javablog" target="_blank" class="btn btn-primary">Buy for Rs. 199</a>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <div class="card bg-light mb-3">
                <div class="card-header">
                    Book you may be interested in..
                </div>
                <div class="card-body">
                    <div class="media">
                        <a href="https://books.shunyafoundation.com/to/sku2?affid=javablog" target="_blank">
                            <img class="mr-3 img-responsive" style="max-height: 170px;" src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/ccji-front-cover.png" alt="Generic placeholder image">
                        </a>
                        <div class="media-body">
                            <h5 class="card-title mt-0"><a href="https://books.shunyafoundation.com/to/sku2?affid=javablog" target="_blank">ebook PDF - Cracking Java Interviews v3.5 by Munish Chandel</a></h5>
                            <nav>
                                <a href="https://books.shunyafoundation.com/to/sku2?affid=javablog" target="_blank" class="btn btn-primary">Buy for Rs. 250</a>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



                <!-- Comments Form -->

                <!-- Single Comment -->

                <!-- Comment with nested comments -->

            </div>

            <!-- Sidebar Widgets Column -->
            <div class="col-md-4">

    <div class="row">
            <div class="col-md-12">
                <div class="card bg-light mb-3">
                    <div class="card-header">
                        Book you may be interested in..
                    </div>
                    <div class="card-body">
                        <div class="media">
                            <a href="https://books.shunyafoundation.com/to/VWVTPZ3A?affid=javablog" target="_blank">
                                <img class="mr-3 img-responsive" style="max-height: 170px;" src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/spring-microservices-interviews-small.jpg" alt="Generic placeholder image">
                            </a>
                            <div class="media-body">
                                <h5 class="card-title mt-0"><a href="https://books.shunyafoundation.com/to/VWVTPZ3A?affid=javablog" target="_blank">ebook PDF - Cracking Spring Microservices Interviews for Java Developers</a></h5>
                                <nav>
                                    <a href="https://books.shunyafoundation.com/to/VWVTPZ3A?affid=javablog" target="_blank" class="btn btn-primary">Buy for Rs. 199</a>
                                </nav>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
    </div>

                <div class="card my-4">
<script async="" src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/f.txt"></script>
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8459438937301460" data-ad-slot="5018545355" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>
                </div>
                <!-- Categories Widget -->

                <!-- Categories Widget -->

                <!-- Side Widget -->
                    <div class="card my-4">
                        <h5 class="card-header">Similar Posts</h5>
    <ul class="list-group list-group-flush">
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <a href="https://www.javacodemonk.com/generating-upi-payment-qr-code-in-java-and-spring-860ede63">
                        <span class="small">Generating UPI Payment QR Code in Java and Spring</span>
                    </a>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <a href="https://www.javacodemonk.com/feign-common-headers-using-requestinterceptor-cbe5d967">
                        <span class="small">Feign common headers using RequestInterceptor</span>
                    </a>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <a href="https://www.javacodemonk.com/send-gupshup-sms-using-java-api-87b4ee6f">
                        <span class="small">Send Gupshup SMS using Java API</span>
                    </a>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <a href="https://www.javacodemonk.com/resttemplate-with-basic-authentication-f66b7e45">
                        <span class="small">RestTemplate with Basic Authentication</span>
                    </a>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <a href="https://www.javacodemonk.com/disable-ssl-certificate-check-resttemplate-e2c53583">
                        <span class="small">Disable SSL certificate validation in RestTemplate </span>
                    </a>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <a href="https://www.javacodemonk.com/how-does-session-handling-works-in-servlet-environment-0b439561">
                        <span class="small">How does Session handling works in Servlet environment</span>
                    </a>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <a href="https://www.javacodemonk.com/logging-connection-timeout-feign-clients-spring-boot-60b8826d">
                        <span class="small">HTTP logging &amp; connection timeout in Feign Clients with Spring Boot</span>
                    </a>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <a href="https://www.javacodemonk.com/sendgrid-emails-spring-boot-java-3aec798d">
                        <span class="small">SendGrid emails with Spring Boot and Java</span>
                    </a>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <a href="https://www.javacodemonk.com/spring-boot-file-upload-with-kotlin-and-junit-5-95bd4c5a">
                        <span class="small">Spring Boot file upload with Kotlin and Junit 5</span>
                    </a>
                </li>
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <a href="https://www.javacodemonk.com/java-8-date-time-json-formatting-with-jackson-5fe5ff13">
                        <span class="small">Java 8 date time JSON formatting with Jackson</span>
                    </a>
                </li>
    </ul>
                    </div>

                <div class="sticky-top">
                    <div class="card my-4">
<script async="" src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/f.txt"></script>
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8459438937301460" data-ad-slot="5649839744" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>
                    </div>
                    <div class="card my-4">
<script async="" src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/f.txt"></script>
<ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-8459438937301460" data-ad-slot="2119917255" data-ad-format="auto" data-full-width-responsive="true"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>
                    </div>
   <div class="card bg-light mb-3 w-100">
       <div class="card-header">Free Email Updates</div>
       <div class="card-body">
           <p class="card-text">Provide email address to subscribe to this blog.</p>
           <form action="https://www.javacodemonk.com/subscribe/apply" method="post">
               <div class="form-group">
                   <input type="email" name="email" class="form-control" id="exampleFormControlInput1" placeholder="Email Address">
               </div>
               <div class="form-group row">
                   <div class="col-sm-10">
                       <button type="submit" class="btn btn-primary">Subscribe</button>
                   </div>
               </div>
<input type="hidden" name="_csrf" value="317852b5-b3bc-4fbc-b0bd-40e070d1aa7e">           </form>
       </div>
   </div>
                </div>

            </div>
        </div>
        <!-- /.row -->

        <hr>
<!-- Cookies -->
<input type="checkbox" id="cookies-close">
<label for="cookies-close" class="cookies-close hide-close-cookies">Got it!</label>
<div id="cookies" class="cookies cookies-hide">
    <p class="cookies-message">This website uses cookies to ensure you get the best experience on our website.  <a href="https://www.javacodemonk.com/privacy-policy" class="cookies-message-link">more info</a></p>
</div>
<!-- End Cookies -->

<!-- Footer -->
<footer class="py-3 bg-primary1 footer">
    <div class="container">
        <div class="row justify-content-md-center">
            <div class="col-md-4 offset-md-1 col-sm-12">
                <ul class="text-left mb-0">
                    <li><a href="https://www.javacodemonk.com/admin">Sign in</a></li>
                    <li><a href="https://www.javacodemonk.com/privacy-policy">Privacy Policy</a></li>
                    <li><a href="https://www.javacodemonk.com/contact-us">Contact us</a></li>
                </ul>
            </div>
            <div class="col-md-4 offset-md-3 col-sm-12">
                <p class="text-center">Find us on social media.</p>
                <ul class="list-inline text-center list-social-icons mb-0">
                    <li class="list-inline-item">
                        <a href="https://www.facebook.com/crackingjavainterviews/" target="_blank" rel="nofollow">
                            <span class="fa-stack fa-lg">
                              <i class="fa fa-circle fa-stack-2x"></i>
                              <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a href="https://www.javacodemonk.com/what-is-n-1-problem-in-hibernate-how-will-you-identify-and-solve-it-894097b9#">
                            <span class="fa-stack fa-lg">
                              <i class="fa fa-circle fa-stack-2x"></i>
                              <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a href="https://www.javacodemonk.com/what-is-n-1-problem-in-hibernate-how-will-you-identify-and-solve-it-894097b9#">
                            <span class="fa-stack fa-lg">
                              <i class="fa fa-circle fa-stack-2x"></i>
                              <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    <li class="list-inline-item">
                        <a href="https://www.javacodemonk.com/what-is-n-1-problem-in-hibernate-how-will-you-identify-and-solve-it-894097b9#">
                            <span class="fa-stack fa-lg">
                              <i class="fa fa-circle fa-stack-2x"></i>
                              <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                </ul>
            </div>
        </div>
        <p class="copyright text-center">Copyright © www.javacodemonk.com 2019-20</p>
    </div>
    <!-- /.container -->
</footer>

<script src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/jquery.min.js"></script>
<script src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/js.cookie.js"></script>
<script>
    $(document).ready(function() {
        if (localStorage.getItem('popState') != 'shown') {
            $('#cookies').addClass("cookies-show");
            $('.cookies-close').addClass("show-close-cookies");
        }

        $('#cookies-close').click(function (e) {
            localStorage.setItem('popState','shown');
            // var number = Math.random();
            // var id = number.toString(36).substr(2, 9); // 'xtis06h6'
            // Cookies.set('ShunyaPlatform', id);
            $('#cookies').removeClass("cookies-show").addClass("cookies-hide");
            $('.cookies-close').removeClass("show-close-cookies").addClass("hide-close-cookies");
        });
    });
</script>

    </div>
    <!-- /.container -->

</main>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/popper.min.js"></script>
<script src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/bootstrap.min.js"></script>
<script src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>

<script type="text/javascript">
  $(".js-social-share").click(function(e) {
      e.preventDefault();

      windowPopup($(this).attr("href")+window.location.href, 500, 300);
  });

  function windowPopup(url, width, height) {
      // Calculate the position of the popup so
      // it’s centered on the screen.
      var left = (screen.width / 2) - (width / 2),
              top = (screen.height / 2) - (height / 2);

      window.open(
              url,
              "",
              "menubar=no,toolbar=no,resizable=yes,scrollbars=yes,width=" + width + ",height=" + height + ",top=" + top + ",left=" + left
      );
  }
</script>

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/firebase-app.js"></script>
<script src="./What is N+1 problem in Hibernate, how will you identify and solve it__files/firebase-messaging.js"></script>
<!-- TODO: Add SDKs for Firebase products that you want to use
 https://firebase.google.com/docs/web/setup#available-libraries -->

<script>
// Your web app's Firebase configuration
var firebaseConfig = {
    apiKey: "AIzaSyCwRywm_KLmAu9Ny0NxworsUmZE-_qt_Es",
    authDomain: "java-android-app.firebaseapp.com",
    databaseURL: "https://java-android-app.firebaseio.com",
    projectId: "java-android-app",
    storageBucket: "java-android-app.appspot.com",
    messagingSenderId: "915536116885",
    appId: "1:915536116885:web:ef1803c4ee35d503fdaf9c"
};
// Initialize Firebase
firebase.initializeApp(firebaseConfig);
</script>

<script>
const messaging = firebase.messaging();

function sendTokenToServer(currentToken) {
    $.ajax({
        url: '/api/fcm/subscribe',
        type: 'POST',
        beforeSend: function (xhr) {
            xhr.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'));
        },
        data: {
            token: currentToken
        },
        success: function (response) {
            setTokenSentToServer(true)
            //TODO: Change its location
            // alert('You are successfully subscribed to topic');
        }
    });
}

function isTokenSentToServer() {
    return window.localStorage.getItem('sentToServer') === '1';
}

function setTokenSentToServer(sent) {
    window.localStorage.setItem('sentToServer', sent ? '1' : '0');
}

function requestPermission() {
    messaging.requestPermission()
        .then(function () {
            console.log('Notification permission granted.');
            messaging.getToken()
                .then(function (currentToken) {
                    console.log('Token is: ' + currentToken);
                    if (currentToken) {
                        if (!isTokenSentToServer()) {
                            console.log("FCM Token not sent to server, sending it now.");
                            sendTokenToServer(currentToken);
                        } else {
                            console.log("FCM Token already sent to server, not sending it again.");
                        }
//                                        updateUIForPushEnabled(currentToken);
                    } else {
                        // Show permission request.
                        console.log('No Instance ID token available. Request permission to generate one.');
                        // Show permission UI.
                        setTokenSentToServer(false);
                        // updateUIForPushPermissionRequired();
                    }
                })
                .catch(function (err) {
                    console.log('An error occurred while retrieving token. ', err);
                    setTokenSentToServer(false);
                });

        })
        .catch(function (err) {
            console.log('Unable to get permission to notify.', err);
        });
}

messaging.onTokenRefresh(function () {
    messaging.getToken()
        .then(function (refreshedToken) {
            console.log('Token refreshed.');
            // Indicate that the new Instance ID token has not yet been sent to the
            // app server.
            setTokenSentToServer(false);
            // Send Instance ID token to app server.
            sendTokenToServer(refreshedToken);
            // ...
        })
        .catch(function (err) {
            console.log('Unable to retrieve refreshed token ', err);
            // showToken('Unable to retrieve refreshed token ', err);
        });
});

$(document).ready(function () {
    requestPermission();
});
</script>


</body></html>