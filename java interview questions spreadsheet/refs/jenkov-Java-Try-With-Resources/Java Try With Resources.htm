<!DOCTYPE html>
<!-- saved from url=(0075)http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="480">
    <!--<meta name="viewport" content="width=device-width, height=device-height initial-scale=1.0, maximum-scale=1.0, user-scalable=0">-->
    <meta name="viewport" content="width=device-width, height=device-height initial-scale=1, user-scalable=1">

    <title>Java Try With Resources</title>

    <meta name="description" content="The Java try-with-resources construct enables you to have resources like an InputStream or JDBC connection automatically closed when you are done using them. This Java try-with-resources tutorial explains how the try-with-resources construct works, and how you use it properly.">
    <meta name="keywords" content="java exception handling try with resources">
    <meta name="author" content="Jakob Jenkov">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@jjenkov">
    <meta name="twitter:title" content="Java Try With Resources">
    <meta name="twitter:description" content="The Java try-with-resources construct enables you to have resources like an InputStream or JDBC connection automatically closed when you are done using them. This Java try-with-resources tutorial explains how the try-with-resources construct works, and how you use it properly.">
    <meta name="twitter:creator" content="@jjenkov">
    <meta name="twitter:domain" content="jenkov.com">

    <meta name="twitter:image:src" content="http://tutorials.jenkov.com/images/java-exception-handling/java-exception-handling-teaser-500-300.png">

    <meta name="og:type" content="article">
    <meta name="og:title" content="Java Try With Resources">
    <meta property="og:url" content="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html">
    <meta property="og:description" content="The Java try-with-resources construct enables you to have resources like an InputStream or JDBC connection automatically closed when you are done using them. This Java try-with-resources tutorial explains how the try-with-resources construct works, and how you use it properly.">

    <meta property="og:image" content="http://tutorials.jenkov.com/images/java-exception-handling/java-exception-handling-teaser-500-300.png">

    <link href="https://plus.google.com/108227213807945109821" rel="publisher">

    <meta name="google-site-verification" content="i_TwzdElg-by5uXLvyAjuIaCjxo0yjtW8LdRPUDEEcw">
<script charset="utf-8" src="./Java Try With Resources_files/button.a657e8de41cd5e7b38cde1f36c9ab9c2.js"></script></head>

<body>

<style>
body {background-color: #f0f0f0; xbackground-image: linear-gradient(180deg, #f0f0f0, #e0e0e0); margin: 0px; font-family: arial;}

.grid {
  display: grid;

}
.topBar, .footer {
  grid-column-start: 1;
  grid-column-end: 12;
  background-color: #000000;
  color: #ffffff;
  height: 64px;
  box-shadow: 0px 8px 6px -6px #999999;
}

.content {
  grid-column-start: 1;
  grid-column-end: 12;
  text-align: center;
}
.category, .main, .right {
	display: inline-block;
    vertical-align: top;
	box-sizing: border-box;
	text-align: left;
}
.footer {
  height: 64px;
  position: relative;
  padding-bottom: 48px;
}
#footerCopyright {
	position: absolute;
	top: 20px;
	left:20px;
}

.card{ background-color: #ffffff; box-shadow: 0px 8px 6px -6px #999999;padding: 20px 30px;border: 1px solid #e0e0e0; margin: 8px 4px;}
.cardLeft  { margin-left:   8px; }
.cardRight { margin-right:  8px; }
.cardTop   { margin-top:    8px; }
.cardBottom{ margin-bottom: 8px; }

#topBarMenu    { position: absolute; top: 20px; left: 20px; }
#topBarMenu a  { color: #ffffff; text-decoration: none; }
#topBarLogoBox { text-align: right; padding-top:6px; margin-right: 16px;}
#topBarLogo    { height: 38px; }
#topBarPhrase  { padding-right: 4px; font-size: 0.8em; }
</style>

<style>
a{ text-decoration:none; }
#main, #mainBody { text-align: left; }

#mainBody h1{margin-top: 0px; text-align:left; }
#mainBody h2{margin: 24px 0px 0px 0px; text-align:left; }
#mainBody a{font-weight: bold; color: #339;}
#mainBody img{max-width:100%;}
#mainBody svg{max-width:100%;overflow: auto;}

.card{ background-color: #ffffff; box-shadow: 0px 8px 6px -6px #999999;padding: 20px 30px;border: 1px solid #e0e0e0;}
#trailToc ol li{border-bottom: 1px solid #f0f0f0;padding: 4px 20px;vertical-align: top;}
.codeBox {background-color: #f0f0f0;border: 1px solid #cccccc;padding: 10px;max-width: 100%;overflow: auto;}
code{font-size: 1.2em;}
.dataTable{background-color: #f0f0f0;border: 1px solid #cccccc;max-width: 100%;overflow: auto;}
.dataTable th{text-align: left;}
.dataTable th, .dataTable td{padding: 2px 8px; }
#pageToc{border: 1px solid #f0f0f0; text-align:left; }
#pageToc li{margin: 6px 0px;}
#pageToc a{color: #339;font-weight: normal;}
#lastUpdate{border: 1px solid #f0f0f0;border-top:none;padding: 6px 24px;font-size: 0.8em;color: #666; text-align:left; }
#next{border-top: 1px solid #f0f0f0;padding: 10px 0px;font-size: 1.1em;}
#bottomSocial{border-top: 1px solid #f0f0f0;padding: 10px 0px;font-size: 0.9em;}
</style>


<style>
@media only screen and (max-width: 799px) {
	.main     { width: 100%;}
	.category { display: none; }
	.right    {	display: none; }
	.card     { padding: 10px 8px; margin: 8px 0px;}
    .bigScreen{ display: none; }
}
@media only screen and (min-width: 800px) and (max-width: 1199px) {
	.main     { width: 75%; }
	.category {	width: 25%;	}
	.right    { display:none;}
	.smallScreen { display: none; }
}
@media only screen and (min-width: 1200px) {
	.main     { width: 50%;	max-width: 900px; }
	.category { width: 25%;	max-width: 300px; }
	.right    { width: 25%; max-width: 400px; display:none;}
	.smallScreen { display: none; }
}

@media only screen and (max-width: 600px) {
  #topBarLogo{transform: scale(0.75, 0.75) translate(0px, 0px);}
}
@media only screen and (max-width: 480px) {
  #topBarLogo{transform: scale(0.6, 0.6) translate(136px, 0px);}
  #topBarMenu a{ font-size: 0.8em; }
  h1{ font-size: 1.6em; }
  h2{ font-size: 1.4em; }
  h3{ font-size: 1.2em; }
}
</style>

<div class="grid">

    <div class="topBar">

        <div id="topBarMenu">
            <a href="http://tutorials.jenkov.com/" title="Tutorials">Tutorials</a>
            &nbsp;&nbsp;&nbsp;
            <a href="http://jenkov.com/about/index.html" title="Tutorials">About</a>
            &nbsp;&nbsp;&nbsp;
            <a href="http://jenkov.com/rss.xml" title="RSS">RSS</a>
        </div>

        <div id="topBarLogoBox">
            <div id="topBarLogo"><svg x="0px" y="0px" width="409px" height="48px" viewBox="0 0 409 100" style="enable-background:new 0 0 409 100;" xml:space="preserve">  <path d="M53,32 l10,0  l0,26  c-7,21 -30,21 -53,10  l4,-9  c18,11 33,10 39,-3  z " style="stroke: none; stroke-width: 1; fill: #ffffff;"></path>  <path d="M69,32 l50,0  l0,9  l-50,0 z" style="stroke: none; stroke-width: 1; fill: #ffffff;"></path>  <path d="M69,49 l50,0  l0,9  l-50,0 z" style="stroke: none; stroke-width: 1; fill: #ffffff;"></path>  <path d="M69,65 l50,0  l0,9  l-50,0 z" style="stroke: none; stroke-width: 1; fill: #ffffff;"></path>  <path d="M126,32 l13,0  l40,31  l0,-31  l10,0  l0,42  l-10,0 l-43,-32 l0,32 l-10,0 z " style="stroke: none; stroke-width: 1; fill: #ffffff;"></path>  <path d="M179,32  l10,0  l0,15 l5,0  l32.5,-14.5  l19,0  l-41,19  l40,22  l-19,0  l-33,-18  l-3.5,0  l0,19  l-10,0 z " style="stroke: none; stroke-width: 1; fill: #ffffff;"></path>  <path d="M238,49  c10,-24 60,-24 70,0  l-11,0  c-10,-12 -38,-12 -48,0  z " style="stroke: none; stroke-width: 1; fill: #ffffff;"></path>  <path d="M238,57  c10,24 60,24 70,0  l-11,0  c-10,12 -38,12 -48,0  z " style="stroke: none; stroke-width: 1; fill: #ffffff;"></path>  <path d="M304,32  l13,0  l25,34 l25,-34  l13,0  l-32,42 l-12.5,0 z" style="stroke: none; stroke-width: 1; fill: #ffffff;"></path>  <path d="M369,65  l12,0 l0,8 l-12,0 z" style="stroke: none; stroke-width: 1; fill: #ffffff;"></path>  <path d="M390,53  c3,-27 54,-27 67,-10  l-15,0  c-10,-5 -40,-5 -41.5,10 l-10,0  " style="stroke: none;  stroke-width: 1; fill: #ffffff;"></path>  <path d="M390,53  c3,27 54,27 67,10  l-15,0  c-10,5 -40,5 -41.5,-10 l-10,0  " style="stroke: none;  stroke-width: 1; fill: #ffffff;"></path>  <path d="M460,49  c10,-24 60,-24 70,0  l-11,0  c-10,-12 -38,-12 -48,0  z " style="stroke: none; stroke-width: 1; fill: #ffffff;"></path>  <path d="M460,57  c10,24 60,24 70,0  l-11,0  c-10,12 -38,12 -48,0  z " style="stroke: none; stroke-width: 1; fill: #ffffff;"></path>  <path d="M534,34  l10,0  l0,6 c13,-10 26,-10 37,0  c12,-10 32,-10 39,3  l0,30  l-10,0  l0,-27  c-3,-9 -24,-9 -28,3 l0,24  -10,0  l0,-27  c-3,-9 -24,-9 -28,3 l0,24  -10,0 z" style="stroke: none; stroke-width: 1; fill: #ffffff;"></path></svg></div>
            <div id="topBarPhrase">Tech and Media Labs</div>
        </div>

    </div>


    <div class="content">
        <div class="site-menu">

            <!--
              <div class="card cardLeft cardTop">Software Development
                <ul>
                  <li>Java &amp; JVM</li>
                  <li>Web</li>
                  <li>Distributed Systems</li>
                </ul>
            </div>
            -->
        </div><div class="category">
        <div id="trailToc" class="card cardTop cardBottom">
            <div id="trailTitle">Java Exception Handling</div><ol><li><a href="http://tutorials.jenkov.com/java-exception-handling/index.html">Java Exception Handling</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/basic-try-catch-finally.html">Basic try-catch-finally Exception Handling in Java</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html"><b>Java Try With Resources</b></a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/catching-multiple-exceptions.html">Catching Multiple Exceptions in Java 7</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/exception-hierarchies.html">Exception Hierarchies</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/checked-or-unchecked-exceptions.html">Checked or Unchecked Exceptions?</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/exception-wrapping.html">Exception Wrapping</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/fail-safe-exception-handling.html">Fail Safe Exception Handling</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/pluggable-exception-handlers.html">Pluggable Exception Handlers</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/logging-where-to-log-exceptions.html">Logging Exceptions: Where to Log Exceptions?</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/validation-throw-exceptions-early.html">Validation - Throw Exceptions Early</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/validation-throw-exception-or-return-false.html">Validation - Throw Exception or Return False?</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/exception-handling-templates.html">Exception Handling Templates in Java</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/exception-enrichment.html">Exception Enrichment in Java</a></li><li><a href="http://tutorials.jenkov.com/exception-handling-strategies/execution-context.html">Execution Context</a></li></ol>
        </div>
    </div><div class="main">
        <div class="card cardTop cardBottom">
            <h1 style="text-align: left;">Java Try With Resources</h1>

            <div id="pageToc" itemscope="" itemtype="http://schema.org/SiteNavigationElement">
                <ul><li><a href="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html#try-with-resources-video">Try-with-resources Video</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html#try-with-resources">Try-with-resources</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html#try-with-resources-java-9-enhancement">Try-with-resources Java 9 Enhancement</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html#using-multiple-resources">Using Multiple Resources</a><ul><li><a href="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html#closing-order">Closing Order</a></li></ul></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html#custom-autoclosable-implementations">Custom AutoClosable Implementations</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html#try-with-resources-exception-handling">Try-with-resources Exception Handling</a><ul><li><a href="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html#catch-block">Catch Block</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html#finally-block">Finally Block</a></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html#adding-suppressed-exceptions-manually">Adding Suppressed Exceptions Manually</a></li></ul></li><li><a href="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html#resource-management-old-school">Resource Management With Try-Catch-Finally, Old School Style</a></li></ul>
            </div>
            <div id="lastUpdate">
                <table><tbody><tr><td class="authorPhoto"></td>
                    <td><p style="margin: 0px 0px 6px 0px;">
                        Jakob Jenkov<br>
                        Last update: 2019-08-25
                    </p>
                        <div class="authorSocialLinks"></div>
                    </td>
                </tr>
                </tbody></table>
            </div>

            <div id="mainBody">
                <p>
    The Java <em>try with resources</em> construct, AKA <em>Java try-with-resources</em>, is an exception handling mechanism
    that can automatically close resources like a Java InputStream or a JDBC Connection when you are done
    with them. To do so, you must open and use the resource within a Java <em>try-with-resources</em> block. When the execution
    leaves the <em>try-with-resources</em> block, any resource opened within the <em>try-with-resources</em> block is automatically closed,
    regardless of whether any exceptions are thrown either from inside the <em>try-with-resources</em> block, or when attempting
    to close the resources.
</p>

<p>
    This <em>Java try-with-resources tutorial</em> explains how the <em>Java try-with-resources</em> construct works, how to properly use it,
    and how exceptions are handled that are thrown both from inside the <em>try-with-resources</em> block, and during the
    closing of the resources.
</p>



<a name="try-with-resources-video"></a>
<h2>Try-with-resources Video</h2>

<p>
    I have created a video version of this Java try-with-resources tutorial, in case you prefer that:
</p>

<iframe width="560" height="315" src="./Java Try With Resources_files/GBtQW3XF3Lg.html" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>




<a name="try-with-resources"></a>
<h2>Try-with-resources</h2>
<p>
    To see how the Java <em>try-with-resources</em> construct work, let us look at a Java <em>try-with-resources</em> example:
</p>

<pre class="codeBox">private static void printFile() throws IOException {

    try(FileInputStream input = new FileInputStream("file.txt")) {

        int data = input.read();
        while(data != -1){
            System.out.print((char) data);
            data = input.read();
        }
    }
}
</pre>

<p>
    This <em>try-with-resources</em> example shows how to open a <a href="http://tutorials.jenkov.com/java-io/fileinputstream.html">Java FileInputStream</a>
    inside a <em>try-with-resources</em> block, read some data from the <code>FileInputStream</code>, and have the
    <code>FileInputStream</code> closed automatically once execution leaves the <em>try-with-resources</em> block
    (not explicitly visible).
</p>

<p>
    Notice the first line inside the method in the <em>try-with-resources</em> example above:
</p>

<pre class="codeBox">try(FileInputStream input = new FileInputStream("file.txt")) {
</pre>


<p>
    This is the <em>try-with-resources</em> construct. The <code>FileInputStream</code>
    variable is declared inside the parentheses after the <code>try</code> keyword. Additionally,
    a <code>FileInputStream</code> is instantiated and assigned to the variable.
</p>

<p>
    When the <code>try</code> block finishes the <code>FileInputStream</code> will be closed
    automatically. This is possible because <code>FileInputStream</code> implements the
    Java interface <code>java.lang.AutoCloseable</code>. All classes implementing this
    interface can be used inside the try-with-resources construct.
</p>



<a name="try-with-resources-java-9-enhancement"></a>
<h2>Try-with-resources Java 9 Enhancement</h2>

<p>
    Before Java 9 a resource that is to be automatically closed must be created inside the parentheses of
    the <em>try</em> block of a try-with-resources construct. From Java 9, this is no longer necessary. If
    the variable referencing the resource is effectively final, you can simply enter a reference to the variable
    inside the try block parentheses. Here is an example of the Java 9 <em>try-with-resources</em> enhancement:
</p>

<pre class="codeBox">private static void printFile() throws IOException {
    FileInputStream input = new FileInputStream("file.txt");
    try(input) {

        int data = input.read();
        while(data != -1){
            System.out.print((char) data);
            data = input.read();
        }
    }
}
</pre>

<p>
    Notice how the <code>input</code> variable is now declared and has a <code>FileInputStream</code> assigned
    outside the <em>try</em> block. Notice also, how the <code>input</code> variable is references inside the parentheses
    of the <em>try</em> block. This way, Java will still close it properly once the <em>try</em> block is exited.
</p>



<a name="using-multiple-resources"></a>
<h2>Using Multiple Resources</h2>
<p>
    You can use multiple resources inside a Java <em>try-with-resources</em> block and have
    them all automatically closed. Here is an example of using multiple resources inside a <em>try-with-resources</em>
    block:
</p>

<pre class="codeBox">private static void printFile() throws IOException {

    try(  FileInputStream     input         = new FileInputStream("file.txt");
          BufferedInputStream bufferedInput = new BufferedInputStream(input)
    ) {

        int data = bufferedInput.read();
        while(data != -1){
            System.out.print((char) data);
            data = bufferedInput.read();
        }
    }
}
</pre>

<p>
    This example creates two resources inside the parentheses after the <em>try</em> keyword.
    An <code>FileInputStream</code> and a <code>BufferedInputStream</code>. Both of these resources
    will be closed automatically when execution leaves the <em>try</em> block.
</p>


<a name="closing-order"></a>
<h3>Closing Order</h3>

<p>
    The resources declared in a Java try-with-resources construct will be closed in reverse order of the order
    in which they are created / listed inside the parentheses. In the example in the previous
    section, first the <a href="http://tutorials.jenkov.com/java-exception-handling/try-with-resources.html"></a><bufferedinputstream< code=""> will be closed, then the <code>FileInputStream</code>.
</bufferedinputstream<></p>



<a name="custom-autoclosable-implementations"></a>
<h2>Custom AutoClosable Implementations</h2>

<p>
    The Java <em>try-with-resources</em> construct does not just work with Java's built-in classes.
    You can also implement the <code>java.lang.AutoCloseable</code> interface in your own classes,
    and use them with the <em>try-with-resources</em> construct.
</p>

<p>
    The <code>AutoClosable</code> interface only has a single method called <code>close()</code>.
    Here is how the interface looks:
</p>

<pre class="codeBox">public interface AutoClosable {

    public void close() throws Exception;
}
</pre>

<p>
    Any class that implements this interface can be used with the Java <em>try-with-resources</em> construct.
    Here is a simple example implementation:
</p>

<pre class="codeBox">public class MyAutoClosable implements AutoCloseable {

    public void doIt() {
        System.out.println("MyAutoClosable doing it!");
    }

    @Override
    public void close() throws Exception {
        System.out.println("MyAutoClosable closed!");
    }
}
</pre>

<p>
    The <code>doIt()</code> method is not part of the <code>AutoClosable</code> interface. It is there because
    we want to be able to do something more than just closing the object.
</p>

<p>
    Here is an example of how the <code>MyAutoClosable</code> is used with the <em>try-with-resources</em>
    construct:
</p>


<pre class="codeBox">private static void myAutoClosable() throws Exception {

    try(MyAutoClosable myAutoClosable = new MyAutoClosable()){
        myAutoClosable.doIt();
    }
}
</pre>

<p>
    Here is the output printed to <code>System.out</code> when the method <code>myAutoClosable()</code>
    is called:
</p>

<pre class="codeBox">MyAutoClosable doing it!
MyAutoClosable closed!
</pre>



<p>
    As you can see, <em>try-with-resources</em> is a quite powerful way of making sure that resources
    used inside a <code>try-catch</code> block are closed correctly, no matter if these resources are your
    own creation, or Java's built-in components.
</p>




<a name="try-with-resources-exception-handling"></a>
<h2>Try-with-resources Exception Handling</h2>

<p>
    The exception handling semantics of a Java <em>try-with-resources</em> block vary a bit from the exception handling
    semantics of a standard Java <em>try-catch-finally</em> block. In most situations the changed semantics will work
    better for you than the semantics of the original <em>try-catch-finally</em> block, even without you understanding
    the difference precisely. Even so, it can be a good idea to actually understand what is going on exception handling
    wise, in the <em>try-with-resources</em> construct. Therefore I will explain the exception handling semantics
    of the <em>try-with-resources</em> construct here.
</p>

<p>
    If an exception is thrown from within a Java <em>try-with-resources</em> block, any resource opened inside
    the parentheses of the <em>try</em> block will still get closed automatically. The throwing of the exception
    will force the execution to leave the <em>try</em> block, and this will force the automatic closing of the
    resource. The exception thrown from inside the <em>try</em> block will get propagated up the call stack,
    once the resources have been closed.
</p>

<p>
    Some resources may also throw exceptions when you try to close them. In case a resource throws an exception
    when you try to close it, any other resources opened within the same <em>try-with-resources</em> block
    will still get closed. After closing all resources, the exception from the failed close-attempt will get
    propagated up the call stack. In case multiple exceptions are thrown from multiple resource close attempts,
    the first exception encountered will be the one propagated up the call stack. The rest of the exceptions will
    be suppressed.
</p>

<p>
    If an exception is thrown both from inside the <em>try-with-resources</em> block,
    and when a resource is closed (when <code>close()</code> is called),
    the exception thrown inside the <em>try</em> block will be propagated up the call stack.
    The exception thrown when the resource was attempted closed will be suppressed.
    This is opposite of what happens in a normal <a href="http://tutorials.jenkov.com/java-exception-handling/basic-try-catch-finally.html">try-catch-finally</a> block,
    where the last exception encountered is the exception that is propagated up the call stack.
</p>

<p>
    To better understand the exception handling semantics of the Java <em>try-with-resources</em> construct,
    let us look at some examples. For these examples I have created the following <code>AutoClosable</code> implementation
    which I can force to throw exceptions both when used and when attempted closed:
</p>

<pre class="codeBox">public class AutoClosableResource implements AutoCloseable {

    private String   name                 = null;
    private boolean throwExceptionOnClose = false;

    public AutoClosableResource(String name, boolean throwExceptionOnClose) {
        this.name = name;
        this.throwExceptionOnClose = throwExceptionOnClose;
    }

    public void doOp(boolean throwException) throws Exception {
        System.out.println("Resource " + this.name + " doing operation");
        if(throwException) {
            throw new Exception("Error when calling doOp() on resource " + this.name);
        }
    }

    @Override
    public void close() throws Exception {
        System.out.println("Resource " + this.name + " close() called");
        if(this.throwExceptionOnClose){
            throw new Exception("Error when trying to close resource " + this.name);
        }
    }
}
</pre>

<p>
    First, let us look at a basic example with a single resource in use:
</p>

<pre class="codeBox">public static void main(String[] args){
    try {
        tryWithResourcesSingleResource();
    } catch (Exception e) {
        e.printStackTrace();
        Throwable[] suppressed = e.getSuppressed();
    }
}

public static void tryWithResourcesSingleResource() throws Exception {
    try(AutoClosableResource resourceOne = new AutoClosableResource("One", false)) {
        resourceOne.doOp(false);
    }
}
</pre>

<p>
    In case the second parameter to the <code>AutoClosableResource</code> construct was changed to <code>true</code>,
    it would throw an exception when attempted closed. In that case, the exception thrown when attempted closed will
    be propagated up the call stack to the <code>main()</code> method where the <em>try-catch</em> block will catch
    it. In that case, the <code>Throwable</code> array returned from <code>e.getSuppessed()</code> will be an empty
    array (size of 0).
</p>

<p>
    In case the parameter to <code>resourceOne.doOp()</code> was changed to <code>true</code> also, the <code>doOp()</code>
    method would throw an exception. In that case, it is this exception that is propagated up the call stack to
    the <code>main()</code> method. The exception thrown when attempting to close the resource would be available inside
    the <code>Throwable</code> array returned by <code>e.getSuppressed()</code>.
</p>

<p>
    Let us look at an example with two <code>AutoClosable</code> resources in use:
</p>

<pre class="codeBox">public static void main(String[] args){
    try {
        tryWithResourcesTwoResources();
    } catch (Exception e) {
        e.printStackTrace();
        Throwable[] suppressed = e.getSuppressed();
        System.out.println("suppressed = " + suppressed);
    }
}

public static void tryWithResourcesTwoResources() throws Exception {
    try(AutoClosableResource resourceOne = new AutoClosableResource("One", true);
        AutoClosableResource resourceTwo = new AutoClosableResource("Two", true)
    ){
        resourceOne.doOp(true);
        resourceTwo.doOp(false);
    }
}
</pre>

<p>
    In the case where only one of the resources throw an exception, either during use or when attempted closed,
    the behaviour is the same as when only one resource is used. However, in the example above I have forced
    both resources to throw an exception when attempted closed, and the first resource to throw an exception when
    used (when <code>doOp()</code> is called). In that case, the exception thrown from inside the
    <em>try</em> block is propagated up the call stack. The two exceptions thrown when attempting to close the
    resources are available in the <code>Throwable</code> array returned by <code>e.getSuppressed()</code>.
</p>

<p>
    Remember, only a single exception can be thrown inside the <em>try</em> block. As soon as an exception is thrown,
    the <em>try</em> block code is exited, and the resources attempted closed.
</p>



<a name="catch-block"></a>
<h3>Catch Block</h3>

<p>
    You can add a <em>catch</em> block to a <em>try-with-resources</em> block just like you can to a standard
    <em>try</em> block. If an exception is thrown from within the <em>try</em> block of a <em>try-with-resources</em>
    block, the <em>catch</em> block will catch it, just like it would when used with a standard <em>try</em> construct.
</p>

<p>
    Before the <em>catch</em> block is entered, the <em>try-with-resources</em>  construct will attempt to close the
    resources opened inside the <em>try</em> block. In case an exception is thrown when attempting to close one of
    the resources, these exceptions will be available from the exception's <code>getSuppressed()</code> method inside
    the <em>catch</em> block. Here is an example of a Java <em>try-with-resources</em> block with a <em>catch</em>
    block attached:
</p>

<pre class="codeBox">try(AutoClosableResource resourceOne = new AutoClosableResource("One", true)) {
    resourceOne.doOp(true);
} catch(Exception e) {
    Throwable[] suppressed = e.getSuppressed();
    throw e;
}
</pre>

<p>
    In the example above, the <code>AutoClosableResource</code> is configured to throw an exception both when
    <code>doOp()</code> is called, and when it is attempted closed (via <code>close()</code>). The exception thrown
    from <code>doOp()</code> is caught in the <em>catch</em> block, its <code>getSuppressed()</code> method returns
    an array with the exception thrown when the resource was attempted closed.
</p>

<p>
    In case that an exception is only thrown when the resource is attempted closed, the <em>catch</em> block will
    also catch it. The <code>getSuppressed()</code> method of that exception will return an empty array, since no
    exceptions where suppressed.
</p>



<a name="finally-block"></a>
<h3>Finally Block</h3>

<p>
    It is also possible to add a <em>finally</em> block to a Java <em>try-with-resources</em> block. It will behave
    just like a standard <em>finally</em> block, meaning it will get executed as the last step before exiting the
    <em>try-with-resources</em> block - after any <em>catch</em> block has been executed.
</p>

<p>
    In case you throw an exception from within the <em>finally</em> block of a <em>try-with-resources</em> construct,
    all previously thrown exceptions will be lost! Here is an example of throwing an exception from within the
    <em>finally</em> block of a Java <em>try-with-resources</em> construct:
</p>

<pre class="codeBox">public static void main(String[] args){
    try {
        tryWithResourcesSingleResource();
    } catch (Exception e) {
        e.printStackTrace();
        Throwable[] suppressed = e.getSuppressed();
    }
}

public static void tryWithResourcesSingleResource() throws Exception {
    try(AutoClosableResource resourceOne = new AutoClosableResource("One", true)) {
        resourceOne.doOp(false);
    } catch(Exception e) {
        Throwable[] suppressed = e.getSuppressed();
        throw e;
    } finally {
        throw new Exception("Hey, an exception from the finally block");
    }
}
</pre>

<p>
    Notice, that the exception thrown from within the <em>catch</em> block will be ignored because a new exception
    is thrown from within the <em>finally</em> block. This would also be true if there was no <em>catch</em> block.
    Then any exception thrown from inside the <em>try</em> block would get lost because a new exception is thrown
    from inside the <em>finally</em> block. Any previous exceptions are not suppressed, so they are not available
    from within the exception thrown from the <em>finally</em> block.
</p>



<a name="adding-suppressed-exceptions-manually"></a>
<h3>Adding Suppressed Exceptions Manually</h3>

<p>
    The <code>Throwable</code> class has a method named <code>addSuppressed()</code> which takes a <code>Throwable</code>
    object as parameter. Using the <code>addSuppressed()</code> method it is possible to add suppressed exceptions to
    another exception, in case you need that. Here is an example that shows how to add suppressed exceptions to a
    Java exception manually:
</p>

<pre class="codeBox">Exception finalException = null;
try(AutoClosableResource resourceOne = new AutoClosableResource("One", true)) {
    resourceOne.doOp(false);
} catch(Exception e) {
    finalException = new Exception("Error...");
    finalException.addSuppressed(e);
    for(Throwable suppressed : e.getSuppressed()){
        finalException.addSuppressed(suppressed);
    }
} finally {
    if(finalException != null){
        throw finalException;
    }
}
</pre>

<p>
    Notice how the <code>Throwable</code> reference has to be declared outside the <em>try-with-resources</em> construct.
    Otherwise the <em>catch</em> and <em>finally</em> blocks cannot access it.
</p>

<p>
    In most cases you will not need to add suppressed exceptions to an exception manually, but now you have at least
    seen how it can be done, in case you ever run into a situation where you need it.
</p>




<a name="resource-management-old-school"></a>
<h2>Resource Management With Try-Catch-Finally, Old School Style</h2>

<p>
    The Java <em>try-with-resources</em> construct was added in Java 7.
    Managing resources that need to be explicitly closed was somewhat tedious
    before Java 7. You had to handle the correct closure of the resources manually. This was not an easy
    task to handle correctly. To understand why, look at the following method which reads a file and prints
    it to the <code>System.out</code>:
</p>

<pre class="codeBox">private static void printFile() throws IOException {
    InputStream input = null;

    try {
        input = <b>new FileInputStream("file.txt");</b>

        int data = <b>input.read();</b>
        while(data != -1){
            System.out.print((char) data);
            data = <b>input.read();</b>
        }
    } finally {
        if(input != null){
            <b>input.close();</b>
        }
    }
}
</pre>


<p>
    The code marked in bold is where the code can throw an <code>Exception</code>. As you can see,
    that can happen in 3 places inside the <code>try</code>-block, and 1 place inside the <code>finally</code>-block.
</p>

<p>
    The <code>finally</code> block is always executed no matter if an exception is thrown from the <code>try</code> block
    or not. That means, that the <code>InputStream</code> is closed no matter what happens in the <code>try</code>
    block. Or, attempted closed that is. The <code>InputStream</code>'s <code>close()</code> method may throw an
    exception too, if closing it fails.
</p>

<p>
    Imagine that an exception is thrown from inside the <code>try</code> block. Then the <code>finally</code> block
    is executed. Imagine then, that an exception is also thrown from the <code>finally</code> block. Which exception
    do you think is propagated up the call stack?
</p>

<p>
    The exception thrown from the <code>finally</code> block would be propagated up the call stack, even if the
    exception thrown from the <code>try</code> block would probably be more relevant to propagate.
</p>

            </div>

            <div id="next">Next: <a href="http://tutorials.jenkov.com/java-exception-handling/catching-multiple-exceptions.html">Catching Multiple Exceptions in Java 7</a></div>
            <div id="bottomSocial">

                <div style="display:inline-block;">
                    <table>
                        <tbody><tr><td colspan="2">
                            <div id="___plus_0" style="position: absolute; width: 450px; left: -10000px;"><iframe ng-non-bindable="" frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position:absolute;top:-10000px;width:450px;margin:0px;border-style:none" tabindex="0" vspace="0" width="100%" id="I0_1581612919177" name="I0_1581612919177" src="./Java Try With Resources_files/sharebutton.html" data-gapiattached="true"></iframe></div><div class="g-plus" data-action="share" data-height="24" data-annotation="none" data-gapiscan="true" data-onload="true" data-gapistub="true"></div>
                            <script src="./Java Try With Resources_files/cb=gapi.loaded_1" async=""></script><script src="./Java Try With Resources_files/cb=gapi.loaded_0" async=""></script><script async="" src="./Java Try With Resources_files/analytics.js"></script><script id="twitter-wjs" src="./Java Try With Resources_files/widgets.js"></script><script type="text/javascript" async="" src="./Java Try With Resources_files/platform.js" gapi_processed="true"></script><script type="text/javascript">
                                (function() {
                                    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
                                    po.src = 'https://apis.google.com/js/platform.js';
                                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
                                 })();
                            </script>

                            <iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" allowfullscreen="true" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" style="position: static; visibility: visible; width: 61px; height: 20px;" title="Twitter Tweet Button" src="./Java Try With Resources_files/tweet_button.7303c29a8108bca4ac5c9ef008ed8164.en.html"></iframe>
                            <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

                        </td></tr>
                        <tr><td class="authorPhoto"></td><td><p style="margin: 0px 0px 6px 0px;">Jakob Jenkov</p><div class="authorSocialLinks"></div></td></tr>
                    </tbody></table>
                </div>

                <div style="display: none;" class="newsletterForm"></div>

            </div>

        </div>
    </div><div class="right">
        <div class="card cardRight cardTop cardBottom">Right 1
            <div>Right 2</div>
        </div>
    </div>
    </div>
    <div class="footer">
        <div id="footerCopyright">Copyright Jenkov Aps</div>
    </div>
</div>

<style>
.navButton{color: #ffffff; font-weight: bold;}
#trailTocFixedDiv{position: fixed;  top : 0px; left : 0px; width : 100%; height : 100%;  display : none; background-color: #ffffff;}
#trailTocFixedInnerDiv{width: 400px; max-width: 94%; height: calc(100% - 72px); overflow : auto; margin: 20px auto 20px auto; padding: 0px 0px 180px 0px;}
#trailTocFixedInnerDiv th{border-bottom: 1px solid #f0f0f0;padding: 6px 10px;text-align: left;font-size: 1.2em;}
#trailTocFixedInnerDiv td{border-bottom: 1px solid #f0f0f0;padding: 6px 20px;vertical-align: top;}
#trailTocFixedCloseButton{width : 72px; padding: 10px 20px; background-color: #009900; border: 2px solid #006600; color: #ffffff; font-size: 0.8em; font-weight: bold; position: absolute; right: 0px; cursor: pointer; box-shadow: 2px 2px 2px 2px #cccccc;}
#bottomNavBarDiv{position:fixed; bottom: 0px; width: 100%;  background-color: #202020; border-top: 1px solid #444444;}
.buttonNavBarButtonDivActive{background-color: #404040;}
#bottomNavBarRow>div{border-left: 1px solid #404040; border-right: 1px solid #000000;  height: 48px;  padding-top:16px; text-align: center; cursor: pointer;}
#bottomNavBarDiv a{color: #ffffff; font-weight: bold;}
#bottomNavBarDiv br{display:none;}
#bottomNavBarDiv img{ height: 20px; }
#nextButton2{ display:none; }
@media only screen and (max-width: 700px){
  #bottomNavBarDiv, #bottomNavBarDiv [jqc-cell] { height: 58px; }
  #bottomNavBarDiv [jqc-cell] {padding-top: 12px;}
  #bottomNavBarDiv a { font-size: 0.8em; }
  #bottomNavBarDiv br { display: inline; }
  #nextButton1 { display: none; }
  #nextButton2 { display: inline; }
}
@media only screen and (max-width: 400px){
  #bottomNavBarDiv [jqc-cell] {padding-top: 10px;}
  #bottomNavBarDiv a {font-size: 0.5em;}
  #bottomNavBarDiv img {height: 24px;}
}
</style>


<div id="trailTocFixedDiv">
    <div id="trailTocFixedCloseButton">Close TOC</div>
    <div id="trailTocFixedInnerDiv"></div>
</div>

<style>
#bottomNavBar2Parent{position:fixed; bottom: 0px; width: 100%;  background-color: #202020; border-top: 1px solid #444444;}
#bottomNavBar2>div{border-left: 1px solid #404040; border-right: 1px solid #000000;  height: 48px;  padding-top:16px; text-align: center; cursor: pointer;}


#bottomNavBar2{
  display: grid;
}
#allTrailsButtonDiv2{
  grid-column-start: 1;
  grid-column-end: 3;
}

#trailTocButtonDiv2 {
  grid-column-start: 3;
  grid-column-end: 5;
}

#pageTocButtonDiv2{
  grid-column-start: 5;
  grid-column-end: 7;
}

#prevButtonDiv2 {
  grid-column-start: 7;
  grid-column-end: 9;
}

#nextButtonDiv2 {
  grid-column-start: 9;
  grid-column-end: 13;
}

</style>

<div id="bottomNavBar2Parent">
<div id="bottomNavBar2">

    <div id="allTrailsButtonDiv2">
        <span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAbUlEQVRIx+3SQQrAIAxEUenNewrvmkXUQgVJEwWdQEED4kb+QzSEPw0z389yi6d3JJKaWY5ryBKgxSVS9jgF9OItQkRXRaBxDYHHJeISt34XND5EEHETQcY/iEfcvAkqbD7yAaYB1PkD7AB4TAY0StbUr69awQAAAABJRU5ErkJggg=="></span> <br>
        <span class="navButton" style="position:relative; top:-4px;">All Trails</span>
    </div>

    <div id="trailTocButtonDiv2">
        <span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAPElEQVRIx2P4TwPAgAzoZgEDrQDdLaB6cI1aMHgtoFriGRkWEB3eg9YHo0E08BaM8CAiWoLaFlAL0NwCANELs4XjmhvVAAAAAElFTkSuQmCC"></span> <br>
        <span class="navButton" style="position:relative; top:-4px;">Trail TOC</span>
    </div>

    <div id="pageTocButtonDiv2">
        <span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAANUlEQVRIx2NggIL/VAYM6GDUglELqGcBA4Vg1ALqWkBOhA4uH4wG0cBbMBpEw9QCagG6WQAAX980BcIgiscAAAAASUVORK5CYII="></span> <br>
        <span class="navButton" style="position:relative; top:-4px;">Page TOC</span>
    </div>

    <div id="prevButtonDiv2">
        <span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjAuNvyMY98AAACCSURBVEhL3ZRRCsAgDEM9iez+dxJPUl0K9W+MtKMiC/RL80Lz0eKViNQxRpsvwnvHv8ssvGD8ORzjh7Odf4F34zxK30O1qImEV7Pw0nUJeEuFY/xwspZceKiWVLgqPUC1JQSAc0Iwh2+iZiIkdiqWdobknOslmM8JwcbxELaujSGl3GNH6mWcCMu2AAAAAElFTkSuQmCC"></span> <br>
        <span class="navButton" style="position:relative; top:-4px;">Previous</span>
    </div>

    <div id="nextButtonDiv2">
        <!--<span class="navButton" id="nextButton1_2" style="position:relative; top:-4px;">Next</span>-->
        <span><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAb0lEQVRIx82W2w1AIQhDmcS4/07GScDbu4AvUlMSv9QeA6RohnD3GhF9TAL7DeeK3cYuBEscgss6kBc16VlI2YTULKStIH9aMzXRgTxJlzaECpAQv+okaptSX35gFed+RBWn2jV14FBHJvVnwRT/AGJL6mWb6M7pAAAAAElFTkSuQmCC"></span> <br>
        <span class="navButton" id="nextButton2_2" style="position:relative; top:-4px;">Next</span>
    </div>

</div>
</div>


<script>
var prevArticleInCategory = "/java-exception-handling/basic-try-catch-finally.html";
var nextArticleInCategory = "/java-exception-handling/catching-multiple-exceptions.html";
</script>


<script>
function qid(id) { return document.getElementById(id); }
</script>

<!-- Nav bar code -->
<script>
function toggle(el){
    if(el.isShown == null || el.isShown == false) {
        el.isShown = true;
        el.style.display = "block";
    } else {
        el.isShown = false;
        el.style.display = "none";
    }
}

qid("allTrailsButtonDiv2").addEventListener("mouseup", function(e) {
    location.href="/";
    e.preventDefault();
    e.stopPropagation();
});
qid("trailTocButtonDiv2").addEventListener("mouseup", function(e) {
    var tocHtml = qid("trailToc").innerHTML;
    qid("trailTocFixedInnerDiv").innerHTML = tocHtml + "<br><br><br><br><br><br><br><br><br><br>";
    toggle(qid("trailTocFixedDiv"));
    e.preventDefault();
    e.stopPropagation();
});
qid("trailTocFixedCloseButton").addEventListener("mouseup", function(e) {
    toggle(qid("trailTocFixedDiv"));
    e.preventDefault();
    e.stopPropagation();
});
qid("pageTocButtonDiv2").addEventListener("mouseup", function(e) {
    location.href="#pageToc";
    e.preventDefault();
    e.stopPropagation();
});
qid("prevButtonDiv2").addEventListener("mouseup", function(e) {
    if(prevArticleInCategory != "") {
        location.href = prevArticleInCategory;
    } else {
        alert("This is the first article in this trail");
    }
});
qid("nextButtonDiv2").addEventListener("mouseup", function(e) {
  if(nextArticleInCategory != "") {
    location.href= nextArticleInCategory;
  } else {
    alert("This is the last article in this trail.");
  }
  e.preventDefault();
  e.stopPropagation();
});
</script>


<!-- Google Analytics Script -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-4036229-3', 'auto');
  ga('send', 'pageview');
</script>

<!-- Google Adsense Script -->
<script data-ad-client="ca-pub-5569543489255665" async="" src="./Java Try With Resources_files/f.txt"></script>





<iframe scrolling="no" frameborder="0" allowtransparency="true" src="./Java Try With Resources_files/widget_iframe.7303c29a8108bca4ac5c9ef008ed8164.html" title="Twitter settings iframe" style="display: none;"></iframe><iframe name="oauth2relay360198751" id="oauth2relay360198751" src="./Java Try With Resources_files/postmessageRelay.html" tabindex="-1" aria-hidden="true" style="width: 1px; height: 1px; position: absolute; top: -100px;"></iframe></body></html>