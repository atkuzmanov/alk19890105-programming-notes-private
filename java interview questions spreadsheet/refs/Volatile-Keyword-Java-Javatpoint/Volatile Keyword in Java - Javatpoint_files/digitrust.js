(function(){function g(p,u,n){function q(a,b){if(!u[a]){if(!p[a]){var f="function"==typeof require&&require;if(!b&&f)return f(a,!0);if(l)return l(a,!0);b=Error("Cannot find module '"+a+"'");throw b.code="MODULE_NOT_FOUND",b;}b=u[a]={exports:{}};p[a][0].call(b.exports,function(b){return q(p[a][1][b]||b)},b,b.exports,g,p,u,n)}return u[a].exports}for(var l="function"==typeof require&&require,b=0;b<n.length;b++)q(n[b]);return q}return g})()({1:[function(g,p,u){p.exports="1.5.41"},{}],2:[function(g,p,
u){function n(a,b){a=a||l;var f={current:null,prior:null},c=a.split("."),h=parseInt(c[c.length-1]);if(null==b){h=isNaN(h)?0:h-1;var m=a;c[c.length-1]=new String(h);var e=c.join(".")}else null!=b&&(e=b);f.current=m;f.prior=e;return f}function q(a,b,g){var c;for(c in a)if(a.hasOwnProperty(c)){var f=a[c];-1<f.indexOf(b)&&(a[c]=f.replace(b,g))}}var l=g("../_version.js"),b={prod:{urls:{digitrustHostPath:"https://cdn.digitru.st/prod/%CURRENT_VERSION%/",digitrustRedirect:"https://cdn.digitru.st/prod/%CURRENT_VERSION%/redirect.html",
digitrustIframe:"https://cdn.digitru.st/prod/%CURRENT_VERSION%/dt.html",digitrustIdService:"https://cdn-cf.digitru.st/id/v1",optoutInfo:"http://www.digitru.st/about-this-notice/",adblockCheck:"http://stats.aws.rubiconproject.com/"},redirectInterval:{exp:7},cookie:{version:2,producer:"1CrsdUNAo6",publisher:{domainKeyValue:"",pathKeyValue:"path=/;",maxAgeMiliseconds:6048E5,userObjectKey:"DigiTrust.v1.identity"},digitrust:{domainKeyValue:"domain=.digitru.st;",pathKeyValue:"path=/;",maxAgeMiliseconds:31536E6,
userObjectKey:"DigiTrust.v1.identity",resetKey:"DeleteEverything",challenge:"DTChal",optout:"optout",optoutUser:{id:"",privacy:{optout:!0}},errorUser:{error:!0}}},iframe:{timeoutDuration:1E4,postMessageOrigin:"https://cdn.digitru.st"},crypto:{serverCryptoRate:0},logging:{enable:!1,level:"ERROR"},gvlVendorId:64},build:{urls:{digitrustHostPath:"https://cdn.digitru.st/prod/%PRIOR_VERSION%/",digitrustRedirect:"https://cdn.digitru.st/prod/%PRIOR_VERSION%/redirect.html",digitrustIframe:"https://cdn.digitru.st/prod/%PRIOR_VERSION%/dt.html",
digitrustIdService:"https://cdn-cf.digitru.st/id/v1",optoutInfo:"http://www.digitru.st/about-this-notice/",adblockCheck:"http://stats.aws.rubiconproject.com/"}},local:{urls:{digitrustHostPath:"//localhost/dist/",digitrustRedirect:"//localhost/dist/redirect.html",digitrustIframe:"//local.digitru.st/dist/dt_debug.html",digitrustIdService:"http://local.digitru.st/misc/faked_id_service_v1.json",optoutInfo:"//localhost/dist/info.html",adblockCheck:"//stats.aws.rubiconproject.com/"},iframe:{timeoutDuration:1E4,
postMessageOrigin:"http://local.digitru.st"},crypto:{serverCryptoRate:1},logging:{level:"DEBUG"},gvlVendorId:64}};p.exports={getFullConfig:function(a,f){a=a||l;a=n(a,f);q(b.prod.urls,"%CURRENT_VERSION%",a.current);q(b.build.urls,"%PRIOR_VERSION%",a.prior);return b},computeVersions:n}},{"../_version.js":1}],3:[function(g,p,u){p.exports={current:"prod"}},{}],4:[function(g,p,u){p.exports={en:{memberId:"[DigiTrust Client Error] Missing member ID, add the member ID to the function call options",postMessageOrigin:"[DigiTrust Client Error] Origin of postMessage call was not the official DigiTrust domain",
iframeError:"[DigiTrust Iframe Error] Client could not connect to the iframe",appManifestXHR:"[DigiTrust Publisher Error] Client could not retrieve Publisher App Manifest JSON file",appManifestInvalid:"[DigiTrust Publisher Error] Publisher App Manifest does not contain valid JSON",appNameInvalid:"[DigiTrust App Error] App name does not match available apps in manifest.json",iframeMissingMember:"[DigiTrust Iframe Error] Client did not send Member string",iframeMissingAppName:"[DigiTrust Iframe Error] Client did not send App Name string"}}},
{}],5:[function(g,p,u){p.exports={gdprLanguages:[]}},{}],6:[function(g,p,u){p.exports={member:"",site:"",sample:1,redirects:!1,adblocker:{detection:!1,blockContent:!1,userMessage:"Did you know advertising pays for this brilliant content? Please disable your ad blocker, then press the Reload button below ... and thank you for your visit!",popupFontColor:"#5F615D",popupBackgroundColor:"#FFFFFF",logoSrc:null,logoText:null,pictureSrc:null},consent:{requires:"none",userMessage:'This site uses cookies and is a member of DigiTrust, a non-profit consortium of companies working together to improve your Web experience.  By clicking on this page you agree to the use of cookies. This notice only appears once. <a href="http://www.digitru.st/about-this-notice/">You can read more or opt out of DigiTrust here</a>.',
popupFontColor:"#ffffff",popupBackgroundColor:"#000000"}}},{}],7:[function(g,p,u){p.exports={type:"RSA-OAEP",hash:{name:"SHA-1"},version:4,spki:"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAgrdFWb07eQFRtdmXcnVRpSZFoibNFMZDEZHn71j6oa5Ohw7miu/Cpl77h2Pp/0bLt3dHr6RcinqA9cck2nPjJEw2svSzJOHY1409Cxr7cyAhfmueLazL/C8DOyFSe3e4QGNsJtPTlNy6Etmnb4dvctpm/nQ2nDaPw5wnb0hWI6Ik7wtvjbH9SaCRlXcyEKpF1oXy55jDJeovSxQz9eL+bgObD2Lz43gidU4B/zPhbNI+KmMkV539okyFfmcBwrCQARkh9d3eI8kAH+PptTalApVAefPSGZdWkSvkNw7HEbcnLMWWWXKeF7z2lMBd7RbnCyBUmgtHLY6d8HX6JPWB6QIDAQAB",
jwk:{kty:"RSA",kid:"fb8cd98a-d21b-4cd6-8b3c-182727effee4",n:"grdFWb07eQFRtdmXcnVRpSZFoibNFMZDEZHn71j6oa5Ohw7miu_Cpl77h2Pp_0bLt3dHr6RcinqA9cck2nPjJEw2svSzJOHY1409Cxr7cyAhfmueLazL_C8DOyFSe3e4QGNsJtPTlNy6Etmnb4dvctpm_nQ2nDaPw5wnb0hWI6Ik7wtvjbH9SaCRlXcyEKpF1oXy55jDJeovSxQz9eL-bgObD2Lz43gidU4B_zPhbNI-KmMkV539okyFfmcBwrCQARkh9d3eI8kAH-PptTalApVAefPSGZdWkSvkNw7HEbcnLMWWWXKeF7z2lMBd7RbnCyBUmgtHLY6d8HX6JPWB6Q",e:"AQAB",alg:"RSA-OAEP",ext:!0,key_ops:["encrypt"]}}},{}],8:[function(g,p,u){g=g("./modules/DigiTrust");
void 0!==window&&null==window.DigiTrust&&(window.DigiTrust=g)},{"./modules/DigiTrust":11}],9:[function(g,p,u){function n(a){e||(m="function"===typeof r.createLogger?r.createLogger("DigiTrust_ConfigLoader"):w,e=!0);h=0;q(a,c);return c}function q(e,a){var d=typeof e,k;if(7<h++)return m.warn("DigiTrust load config over recurse page: "+document.location),a;if("object"!=d||null==e)return a;for(k in e)if(e.hasOwnProperty(k)){d=e[k];var t=typeof d;"object"==t?(null==a[k]&&(a[k]={}),t=a[k],a[k]=q(d,t),h--):
a[k]=d}return a}function l(){c=Object.assign({},a.prod);"prod"!=b&&n(f);return c}var b=g("../config/env.json").current,a=g("../config/GeneralConfig").getFullConfig(),f=a[b],r=g("./helpers"),c;g=function(){};var h=0,m={},e=!1,w={log:g,warn:g,info:g,error:g};l();p.exports={loadConfig:n,getValue:function(a){return r.deepGet(c,a)},reset:function(){c=null;l()},all:function(){return c}}},{"../config/GeneralConfig":2,"../config/env.json":3,"./helpers":18}],10:[function(g,p,u){function n(a){this.parent=a||
window.DigiTrust}function q(){var a=window.console;a.log.apply(a,arguments)}function l(a,b){var f=window.console;a?f.group(b):f.groupEnd()}var b=g("./DigiTrustCommunication");n.prototype.isDebug=function(){return this.parent.util.isDebugEnabled()};n.prototype.setDebug=function(a){var f=this.parent.util,g=this.parent.isClient;"boolean"!==typeof a&&(a=!0);a=f.setDebug(a);g&&b.setFrameDebug(!0);return a};n.prototype.dumpLogs=function(a){var f=this.parent.util,g=f.getGlobalLogger().getBuffer();q(f.getGlobalLogger().name);
if(f=null!=a){var c="display: inline-block; color: #fff; background: [BG_COLOR]; padding: 1px 4px; border-radius: 3px;font-size:1.1rem;".replace("[BG_COLOR]",(this.parent||window.DigiTrust).isClient?"#395BA8":"#ff9900");q("%c"+a,c);l(!0,a)}q(g);f&&l(!1);this.parent.isClient&&b.dumpFrameLogs();return g};n.prototype.dumpConfig=function(){var a=DigiTrust._config.initOptions;q(a);return a};p.exports={createDebugControl:function(a){return new n(a||window.DigiTrust)}}},{"./DigiTrustCommunication":12}],
11:[function(g,p,u){var n=g("./ConfigLoader"),q=g("../config/errors.json"),l=g("../config/initializeOptions.json"),b=g("./helpers"),a=g("./DigiTrustConsent"),f=g("./DigiTrustCookie"),r=g("./DigiTrustCommunication");u=g("./DigiTrustCrypto");var c=g("./DebugControl"),h=g("./logger").createLogger("Digitrust",{level:"ERROR",enabled:!1}),m={version:g("../_version.js"),isClient:!1,_config:{loader:n,errors:q,initOptions:l,crypto:u},cookie:f,util:b},e=function(){};m.debugControl=c.createDebugControl(m);m.initializeOptions=
{};var w=function(d){if(d&&0<d.length)return!0;throw q.en.memberId;};m._setDigiTrustOptions=function(d){d=Object.assign({},l,d);window.DigiTrust.initializeOptions=d;h.debug("options set",d);return window.DigiTrust.initializeOptions};var x=!1;m._config.reload=function(){x=!1;m._config.loader.reset()};m._config.getConfig=function(){var d=window.DigiTrust.initializeOptions;d=d&&d.environment||null;var k;if(x)return m._config.loader;var t={},a=["urls","iframe","redirectInterval","redir"];if(null!=d){for(k=
0;k<a.length;k++){var e=void 0,b=t,w=d,c=a[k];try{if(null!=w[c])for(e in null==b[c]&&(b[c]={}),w[c])w[c].hasOwnProperty(e)&&(b[c][e]=w[c][e])}catch(A){}}m._config.loader.loadConfig(t)}x=!0;return m._config.loader};var v=function(d,k){h.debug("initialize of DigiTrust begins",d);try{void 0===k&&(h.debug("noop callback"),k=e);var t={success:!1};d&&d.environment&&(h.debug("loading custom environement settings",d.environment),n.loadConfig(d.environment));d=m._setDigiTrustOptions(d);h=b.createLogger("Digitrust");
h.debug("init options completed");if(Math.random()>d.sample)return k(t);if(!w(d.member))return h.debug("init fail! Invalid DigiTrust member or no member value passed"),k(t);a.hasConsent(null,function(a){if(a)f.getUser(d,function(d,a){d||(t.success=!0,t.identity=a);return k(t)});else return h.debug("user consent missing - fail"),k(t)})}catch(y){return h.error("Error in DigiTrust initializer",y),k({success:!1})}};m.initialize=function(d,k){h=b.createLogger("Digitrust");b.setGlobalLogger(h);var t=window.document,
a=t.readyState;m.isClient=!0;a&&"loading"!=a?v(d,k):t.addEventListener("DOMContentLoaded",function(t){m.initialize(d,k)})};m.getUser=function(d,k){d=m._setDigiTrustOptions(d);var t="function"===typeof k?!0:!1,e={success:!1};try{if(!w(d.member))return!1===t?e:k(e);if(!1===t){var c=f.getUser();b.isEmpty(c)||(e.success=!0,e.identity=c);return e}a.hasConsent(null,function(t){if(t)d.ignoreLocalCookies=!0,f.getUser(d,function(d,t){d||(e.success=!0,e.identity=t);return k(e)});else return k(e)})}catch(z){return!1===
t?e:k(e)}};m.sendReset=function(d,k){r.sendReset()};m.setDebug=function(d){m.debugControl.setDebug(d)};p.exports=m},{"../_version.js":1,"../config/errors.json":4,"../config/initializeOptions.json":6,"./ConfigLoader":9,"./DebugControl":10,"./DigiTrustCommunication":12,"./DigiTrustConsent":13,"./DigiTrustCookie":14,"./DigiTrustCrypto":15,"./helpers":18,"./logger":19}],12:[function(g,p,u){function n(){if(!f){var e=window.DigiTrust.initializeOptions;null!=e.logging&&(0==e.logging.enable?(a=b.createLogger("DigiTrustCommunication",
{level:"ERROR"}),a.enabled=!1):(null==e.logging.level&&(e.logging.level="INFO"),a=b.createLogger("DigiTrustCommunication",e.logging)));f=!0}}function q(e){var a=m(),b=window.DigiTrust._config.getConfig().getValue("iframe.postMessageOrigin"),c=e.data.type;a.debug("pubsub event received: "+e.msgKey,e);if(e.origin!==b)switch(a.info("pubsub event origin does not match iframeOrigin from config: "+e.origin+" : "+b),c){case "Digitrust.shareIdToIframe.request":DigiTrust?DigiTrust.getUser({member:window.DigiTrust.initializeOptions.member},
function(d){d.type="Digitrust.shareIdToIframe.response";e.source.postMessage(d,e.origin)}):a.warn("DigiTrust not found");break;default:a.warn("message origin error. allowed: "+b+" \nwas from: "+e.origin)}else switch(c){case h.ready:r.publish(c,[!0]);break;default:r.publish(c,[e.data.value])}}var l=g("../config/errors.json"),b=g("./logger"),a=b.createLogger("DigiTrustCommunication",{level:"ERROR"}),f=!1,r=g("./MinPubSub").createPubSub({host:location.host}),c={},h={ready:"DigiTrust.iframe.ready",ifrErr:"DigiTrust.iframe.error",
idSync:"DigiTrust.identity.response.sync",idResp:"DigiTrust.identity.response",idReset:"DigiTrust.identity.reset",idGet:"DigiTrust.identity.request",frameDebug:"DigiTrust.iframe.setDebug",frameDumpLogs:"DigiTrust.iframe.dumpLogs",debugMsg:"DigiTrust.iframe.debugMsg"},m=function(){return window.DigiTrust.util.getGlobalLogger()};c.iframe=null;c.iframeStatus=0;c.startConnection=function(e){n();var b=window.DigiTrust._config.getConfig().getValue("iframe"),f=setTimeout(function(){m().warn("pubsub MESSAGE TIMEOUT ERROR");
e(!1);c.iframeStatus=0},b.timeoutDuration);r.subscribe(h.ready,function(a){clearTimeout(f);f=0;c.iframeStatus=2;e(!0)});window.addEventListener("message",q,!1);c.iframe=document.createElement("iframe");c.iframe.style.display="none";c.iframe.src=window.DigiTrust._config.getConfig().getValue("urls.digitrustIframe");c.iframe.name="__dtLocator";c.iframeStatus=1;document.body.appendChild(c.iframe);a.debug("communication frame added")};c.sendRequest=function(a,b){2===c.iframeStatus?a(b):1===c.iframeStatus?
r.subscribe(h.ready,function(e){a(b)}):0===c.iframeStatus&&c.startConnection(function(e){if(e)a(b);else throw Error(l.en.iframeError);})};c.getIdentity=function(a){m().debug("pubsub request identity");a=a?a:{};c.sendRequest(function(a){c.iframe.contentWindow.postMessage({version:1,type:h.idGet,syncOnly:a.syncOnly?a.syncOnly:!1,redirects:a.redirects?a.redirects:!1,value:{}},c.iframe.src)},a)};c.sendReset=function(a){g("./DigiTrustCookie").setResetCookie();c.sendRequest(function(a){c.iframe.contentWindow.postMessage({version:1,
type:h.idReset},c.iframe.src)},a)};c.setFrameDebug=function(a){var e=m();window.DigiTrust.isClient?(a="boolean"==typeof a?{debug:a}:a||{debug:!0},c.sendRequest(function(e){c.iframe.contentWindow.postMessage({value:a.debug||!0,type:h.frameDebug},c.iframe.src)},a)):e.warn("invalid call to DigiTrustCommunication.setFrameDebug. Only valid from client")};c.dumpFrameLogs=function(a){var b=m();window.DigiTrust.isClient?(a=a||{},c.sendRequest(function(a){c.iframe.contentWindow.postMessage({value:{},type:h.frameDumpLogs},
c.iframe.src)},a)):b.warn("invalid call to DigiTrustCommunication.dumpFrameLogs. Only valid from client")};p.exports={getIdentity:c.getIdentity,startConnection:c.startConnection,sendReset:c.sendReset,setFrameDebug:c.setFrameDebug,dumpFrameLogs:c.dumpFrameLogs,MsgKey:h,listen:function(a,b){"function"===typeof b&&r.subscribe(a,b)}}},{"../config/errors.json":4,"./DigiTrustCookie":14,"./MinPubSub":16,"./logger":19}],13:[function(g,p,u){var n=g("../config/env.json").current,q=g("../config/gdpr-lang.json"),
l={browserLanguageIsEU:function(b){for(var a=0;a<b.length;a++)if(0<=q.gdprLanguages.indexOf(b[a].toLowerCase()))return!0;return!1},cmpConsent:function(b){return!1},gdprApplies:function(b){return l.browserLanguageIsEU(navigator.languages||[navigator.browserLanguage])},hasConsent:function(b,a){var f=window.DigiTrust.util.getGlobalLogger(),g=l.gdprApplies(),c=DigiTrust._config.getConfig().getValue("gvlVendorId");if("local"===n||"localdev"===n)g=!1;"undefined"!==typeof window.__cmp?window.__cmp("ping",
null,function(b){g||b.gdprAppliesGlobally?(f.debug("GDPR consent rules apply from language or global GDPR settings."),window.__cmp("getVendorConsents",[c],function(b){b=b.vendorConsents[c];f.debug("GDPR user consent value: "+b);a(b)})):a(!0)}):g?(f.debug("GDPR consent rules apply."),a(!1)):a(!0)}};p.exports={hasConsent:l.hasConsent}},{"../config/env.json":3,"../config/gdpr-lang.json":5}],14:[function(g,p,u){function n(){return window&&window.DigiTrust&&window.DigiTrust._config?window.DigiTrust._config.getConfig():
q}var q=g("./ConfigLoader"),l=g("./DigiTrustCommunication"),b=g("./helpers"),a=function(a){var b=new Date;b.setTime(b.getTime()+a);return b.toUTCString()},f=function(a,b,c,f){a=a+b+c+f;";"!=a.substr(a.length-1)&&(a+=";");document.cookie=a+"SameSite=None; Secure;"},r=function(b){var e=window.DigiTrust.isClient?n().getValue("cookie.publisher"):n().getValue("cookie.digitrust");b=e.userObjectKey+"="+b+";";var c="expires="+a(e.maxAgeMiliseconds)+";";f(b,c,e.domainKeyValue,e.pathKeyValue)},c=function(a){if(!a)return!1;
var b=a.hasOwnProperty("id"),c=a.hasOwnProperty("privacy");return!b||!c||!a.privacy.optout&&1>a.id.length||!c||!a.privacy.hasOwnProperty("optout")?!1:!0},h={getIdentityCookieJSON:function(a){var e=window.DigiTrust.util.getGlobalLogger();a=a||n().getValue("cookie.digitrust.userObjectKey");if(a=h.getCookieByName(a)){e.debug("local user identity cookie found on domain "+location.host);var f={};try{f=h.unobfuscateCookieValue(a)}catch(x){e.warn("error parsing user cookie - generating new identity"),f=
{id:b.generateUserId(),version:n().getValue("cookie.version"),producer:n().getValue("cookie.producer"),privacy:{optout:!1}},r(h.obfuscateCookieValue(f))}if(c(f))return f;e.info("failure in verifying cookie structure "+JSON.stringify(f));return{}}e.debug("no local user identity");return{}},setResetCookie:function(){var b=n().getValue("cookie"),e=b.digitrust.resetKey+"=true;",c="expires="+a(b.digitrust.maxAgeMiliseconds)+";";f(e,c,b.digitrust.domainKeyValue,b.digitrust.pathKeyValue)},expireCookie:function(a){var b=
n().getValue("cookie");a+="=; ";var c="",g=b.digitrust.pathKeyValue;try{-1<location.host.indexOf(b.digitrust.domainKeyValue)&&(c=b.digitrust.domainKeyValue)}catch(v){}f(a,"expires=expires=Thu, 01 Jan 1970 00:00:01 GMT;",c,g)},setDigitrustCookie:function(b){var e=window.DigiTrust.util.getGlobalLogger(),c=n().getValue("cookie");b=c.digitrust.userObjectKey+"="+b+";";var g="expires="+a(c.digitrust.maxAgeMiliseconds)+";",m=c.digitrust.domainKeyValue;c=c.digitrust.pathKeyValue;e.debug("setting identity cookie");
f(b,g,m,c)},getUser:function(a,e){window.DigiTrust.util.getGlobalLogger();var c=n().getValue("cookie");a=a||{};var f={},g=function(){l.listen(l.MsgKey.idSync,function(d){h.verifyPublisherDomainCookie(d)&&(d=h.obfuscateCookieValue(d),r(d))})};if(!1===("function"===typeof e?!0:!1))return f=h.getIdentityCookieJSON(c.publisher.userObjectKey),g(),l.getIdentity({syncOnly:!0}),b.isEmpty(f)?{}:f;l.listen(l.MsgKey.idResp,function(d){if(h.verifyPublisherDomainCookie(d)){var k=h.obfuscateCookieValue(d);r(k);
return e(!1,d)}b.isEmpty(d)&&!d.hasOwnProperty("error")&&a.redirects&&b.createConsentClickListener();return e(!0)});if(!0===a.ignoreLocalCookies)l.getIdentity();else{f=h.getIdentityCookieJSON(c.publisher.userObjectKey);if(h.verifyPublisherDomainCookie(f))return g(),l.getIdentity({syncOnly:!0}),e(!1,f);l.getIdentity({syncOnly:!1,redirects:a.redirects})}},obfuscateCookieValue:function(a){return encodeURIComponent(btoa(JSON.stringify(a)))},unobfuscateCookieValue:function(a){return JSON.parse(atob(decodeURIComponent(a)))},
getCookieByName:function(a){a=("; "+document.cookie).split("; "+a+"=");if(2<=a.length)return a.pop().split(";").shift()},createUserCookiesOnDigitrustDomain:function(){var a=n().getValue("cookie");a={id:b.generateUserId(),version:a.version,producer:a.producer,privacy:{optout:!1}};var c=h.obfuscateCookieValue(a);h.setDigitrustCookie(c);return a},verifyPublisherDomainCookie:function(a){return!b.isEmpty(a)&&c(a)&&a.hasOwnProperty("keyv")?!0:!1}};p.exports=h},{"./ConfigLoader":9,"./DigiTrustCommunication":12,
"./helpers":18}],15:[function(g,p,u){function n(){c||(r=b.createLogger("DigiTrustCrypto"),c=!0)}function q(a){a&&a.subtle||(a=window.crypto);if(!a||!a.subtle)return r.debug("Invalid browser crypt object"),!1;if(!window.msCrypto)return!1;try{return"undefined"!==typeof a.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:2048,publicExponent:new Uint8Array([1,0,1])},!1,["encrypt","decrypt"]).oncomplete?!0:!1}catch(x){return!1}}var l=g("./ConfigLoader"),b=g("./helpers"),a=g("./ServerCrypto"),
f=g("../config/key.json"),r={},c=!1,h=b.getBrowserCrypto(),m=function(a,c,e,d){h.subtle.importKey(c,e,{name:f.type,hash:{name:f.hash.name}},!1,["decrypt"]).oncomplete=function(k){k=h.subtle.decrypt({name:f.type,hash:{name:f.hash.name}},k.target.result,b.base64StringToArrayBuffer(a));k.onerror=function(d){r.error(d)};k.oncomplete=function(a){a=b.ab2str(a.target.result);r.debug("just decrypted",c,a);return d(a)}}},e=function(a,c,e,d){h.subtle.importKey(c,e,{name:f.type,hash:{name:f.hash.name}},!1,["encrypt"]).oncomplete=
function(k){k=k.target.result;try{h.subtle.encrypt({name:f.type,hash:{name:f.hash.name}},k,b.str2ab(a)).oncomplete=function(a){a=a.target.result;a="string"===typeof a?a:b.arrayBufferToBase64String(a);r.debug("just encrypted",c,a);return d(a)}}catch(t){r.error("Digitrust server MSIE Encrypt error",t)}}};p.exports={getKeyVersion:function(){return f.version},encrypt:function(c,g){n();null==h&&(h=b.getBrowserCrypto());if(b.isSafari()){var m="jwk";var d=f.jwk}else m="spki",d=b.base64StringToArrayBuffer(f.spki);
window.crypto&&!window.crypto.subtle&&b.isChrome()&&Math.random()<l.getValue("crypto.serverCryptoRate")&&(h.subtle=a.mockCryptoSubtle());r.debug("encrypt value: ",c);q(h)?e(c,m,d,g):h.subtle.importKey(m,d,{name:f.type,hash:{name:f.hash.name}},!1,["encrypt"]).then(function(a){h.subtle.encrypt({name:f.type,hash:{name:f.hash.name}},a,b.str2ab(c)).then(function(a){a="string"===typeof a?a:b.arrayBufferToBase64String(a);return g(a)}).catch(function(a){r.error("Failure encrypting value.",a)})})},decrypt:function(a,
c){var e="jwk",d=f.jwkPrivate;n();r.debug("attempt to decrypt value: ",a);null==h&&(h=b.getBrowserCrypto());if(b.isSafari()){e="jwk";var k=f.jwk}else e="spki",k=b.base64StringToArrayBuffer(f.spki);q(h)?m(a,e,k,c):(r.debug("ready to create key"),h.subtle.importKey(e,d,{name:f.type,hash:{name:f.hash.name}},!1,["decrypt"]).then(function(d){r.debug("enter decrypt with key",d);h.subtle.decrypt({name:f.type,hash:{name:f.hash.name}},d,b.base64StringToArrayBuffer(a)).then(function(a){a=b.ab2str(a);r.debug("just decrypted",
e,a);return c(a)})}))}}},{"../config/key.json":7,"./ConfigLoader":9,"./ServerCrypto":17,"./helpers":18}],16:[function(g,p,u){function n(g){var l=window.c_||{};this.publish=function(b,a){for(var f=(b=l[b])?b.length:0;f--;)b[f].apply(window,a||[])};this.subscribe=function(b,a){l[b]||(l[b]=[]);l[b].push(a);return[b,a]};this.unsubscribe=function(b,a){var f=l[a?b:b[0]];a=a||b[1];for(b=f?f.length:0;b--;)f[b]===a&&f.splice(b,1)}}p.exports={createPubSub:function(g){return new n(g)}}},{}],17:[function(g,p,
u){var n=g("./ConfigLoader"),q=g("./helpers");p.exports={mockCryptoSubtle:function(){return{importKey:function(g,b,a,f,n){return new Promise(function(a,b){a()})},encrypt:function(g,b,a){return new Promise(function(a,b){q.xhr.promise("GET",(window&&window.DigiTrust&&window.DigiTrust._config?window.DigiTrust._config.getConfig():n).getValue("urls.digitrustIdService")).then(function(b){b=JSON.parse(b);a(b.id)}).catch(function(a){b(a)})})}}}}},{"./ConfigLoader":9,"./helpers":18}],18:[function(g,p,u){function n(){return window&&
window.DigiTrust&&window.DigiTrust._config?window.DigiTrust._config.getConfig():q}var q=g("./ConfigLoader"),l=g("./logger"),b=l.createLogger("DigiTrust_util",{level:"ERROR"}),a={},f=!1,r={version:"mock version"};a.setDebug=function(d){var k=window.DigiTrust.isClient,c="display: inline-block; color: #fff; background: [BG_COLOR]; padding: 1px 4px; border-radius: 3px;font-size:1.1rem;".replace("[BG_COLOR]",k?"#395BA8":"#ff9900"),e=window.DigiTrust||r,g=window.navigator||{},h=b,l=h.prevSettings||{};h.prevSettings=
l;f!=d&&(d?(f=!0,h.prevSettings={enabled:h.enabled,logLevel:{level:h.opts.level}},h.enabled=!0,h.opts.level="DEBUG",b.info(k?"%cDigiTrust Debug Mode Enabled":"%cDigiTrust iFrame Debug Mode Enabled",c),b.group("DigiTrust Library Info"),b.info("DigiTrust version: "+e.version),b.info("Page: "+location.href),b.info("Browser: "+g.userAgent),a.isChrome()&&b.info("Chrome detected - only works with SSL sites"),a.isSafari()&&b.info("Safari detected - cookie restrictions may apply"),b.groupEnd()):(f=!1,h.enabled=
l.enabled,h.logLevel=l.logLevel))};a.isDebugEnabled=function(){return 1==f};a.setGlobalLogger=function(a){return b=a};a.getGlobalLogger=function(){return b};a.extend=function(d,b){d=d||{};for(var k in b)d[k]="object"===typeof b[k]?a.extend(d[k],b[k]):b[k];return d};var c={level:"ERROR",enable:!1},h=function(){var a=window.crypto||window.msCrypto;window.crypto&&!window.crypto.subtle&&window.crypto.webkitSubtle&&(window.crypto.subtle=window.crypto.webkitSubtle);return a},m=function(a,b,c){var d=function(a){var d=
null!=c&&"function"===typeof c?!0:!1;d&&c.call(null,a)};a.addEventListener(b,d);return d},e=function(a,b,c){return new Promise(function(d,k){var c=new XMLHttpRequest;c.open(a,b);c.withCredentials=!0;c.onload=function(){200<=this.status&&300>this.status?d(c.response):k({status:this.status,statusText:c.statusText})};c.onerror=function(){k({status:this.status,statusText:c.statusText})};c.send()})},w=function(a,b,c,e){e=e?e?!0:!1:!0;var d={success:function(){},error:function(){}},k=new (window.XMLHttpRequest||
ActiveXObject)("MSXML2.XMLHTTP.3.0");k.open(a,b,e);k.setRequestHeader("Content-type","application/x-www-form-urlencoded");k.onreadystatechange=function(){4===k.readyState&&(200<=k.status&&300>k.status?d.success.apply(d,[k.responseText,k]):d.error.apply(d,[k.responseText,k]))};k.send(c);var t={success:function(a){d.success=a;return t},error:function(a){d.error=a;return t}};return t};a.xhr={get:function(a,b,c){return w("GET",a,b,c)},put:function(a,b,c){return w("PUT",a,b,c)},post:function(a,b,c){return w("POST",
a,b,c)},delete:function(a,b,c){return w("DELETE",a,b,c)},promise:function(a,b,c){return e(a,b,c)}};var x=function(a){return a?"a"===a.nodeName.toLowerCase()?a.href:"body"===a.nodeName.toLowerCase()?!1:x(a.parentNode):!1};a.getConfig=n;a.createLogger=function(a){a=a||"DigiTrust_default";if(window&&window.DigiTrust&&window.DigiTrust._config){var d=DigiTrust._config.getConfig().getValue("logging");null==d?a=l.createLogger(a,c):0==d.enable?(a=l.createLogger(a,{level:"ERROR"}),a.enabled=!1):(null==d.level&&
(d.level="ERROR"),a=l.createLogger(a,d),a.enabled=1==d.enable||1==d.enabled||!1);return a}return l.createLogger(a,c)};a.getAbsolutePath=function(a){var d=document.createElement("a");d.href=a;return d.cloneNode(!1).href};var v={_settings:{key:null,expire:{val:7,per:"d"},expirePeriods:{d:24,h:1,m:1/60,s:1/3600},checkLoad:function(){var a=v._settings;if(null!=a.key)return!0;var b=n().redirectInterval||{};a.key=b.key||"DigiTrust.v1.redir";b.exp&&(a.expire.val=b.exp);b.experiod&&(a.expire.per=b.experiod)}},
getStore:function(){v._settings.checkLoad();return window.localStorage},ignoreRedirect:function(){var a=v.getStore(),b=v._settings;a=a.getItem(b.key);if(null==a)return!1;try{var c=JSON.parse(a);return(new Date(c.exp)).setHours(b.expire.val*(b.expirePeriods[b.expire.per]||24))<=(new Date).getTime()?(v.clearRedirectFlag(),!1):!0}catch(y){return v.clearRedirectFlag(),!1}},clearRedirectFlag:function(){v.getStore().removeItem(v._settings.key)},clearAll:function(){v.clearRedirectFlag()},setRedirectFlag:function(){var a=
v.getStore(),b=v._settings.key,c={val:!0,exp:(new Date).getTime()};a.setItem(b,JSON.stringify(c))}};a.resetFlags=function(){v.clearAll()};a.createConsentClickListener=function(){try{var a=window.self!==window.top}catch(t){a=!0}if(!a&&!v.ignoreRedirect())var b=m(window,"click",function(a){a=a||window.event;a=a.target||a.srcElement;if("digitrust-optout"===a.id)return!0;a=x(a)||"";var d=a.indexOf("http://"),c=a.indexOf("https://");if(0==d||0==c)return window&&window.removeEventListener&&window.removeEventListener("click",
b),v.setRedirectFlag(),window.location=q.getValue("urls.digitrustRedirect")+"?redirect="+encodeURIComponent(a),!1})};a.generateUserId=function(){var d=new Uint8Array(8);h().getRandomValues(d);return a.arrayBufferToBase64String(d)};a.isEmpty=function(a){if(null===a||"undefined"===typeof a)return!0;if(0<a.length)return!1;if(0===a.length)return!0;for(var b in a)if(hasOwnProperty.call(a,b))return!1;return!0};a.deepGet=function(b,c){if("object"!=typeof b||a.isEmpty(b)||null==c)return null;var d=c.split("."),
e=d.length;for(c=0;c<e;c++){var k=d[c];b=b[k];if(c==e-1||null==b)return b}return null};a.getUrlParameterByName=function(a,b){b=b||location.search;a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=(new RegExp("[\\?&]"+a+"=([^&#]*)")).exec(b);return null===a?"":decodeURIComponent(a[1].replace(/\+/g," "))};a.isIE=function(a){a=a||navigator.userAgent;a=a.toLowerCase();return-1<Math.max(a.indexOf("msie"),a.indexOf("trident"))?!0:!1};a.isSafari=function(a){a=a||navigator.userAgent;a=a.toLowerCase();return-1===
a.indexOf("safari")||-1<a.indexOf("chrome")?!1:!0};a.isChrome=function(a){a=a||navigator.userAgent;a=a.toLowerCase();return-1!==a.indexOf("chrome")?!0:!1};a.isValidJSON=function(a){try{JSON.parse(a)}catch(k){return!1}return!0};a.ab2str=function(a){return String.fromCharCode.apply(null,new Uint8Array(a))};a.str2ab=function(a){for(var b=new ArrayBuffer(a.length),d=new Uint8Array(b),c=0,e=a.length;c<e;c++)d[c]=a.charCodeAt(c);return b};a.arrayBufferToBase64String=function(a){a=new Uint8Array(a);for(var b=
"",c=0;c<a.byteLength;c++)b+=String.fromCharCode(a[c]);return btoa(b)};a.base64StringToArrayBuffer=function(a){a=atob(a);for(var b=a.length,c=new Uint8Array(b),d=0;d<b;d++)c[d]=a.charCodeAt(d);return c.buffer};a.asciiToUint8Array=function(a){for(var b=[],c=0;c<a.length;++c)b.push(a.charCodeAt(c));return new Uint8Array(b)};a.getBrowserCrypto=h;(function(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(a,b){if(null==a)throw new TypeError("Cannot convert undefined or null to object");
for(var c=Object(a),d=1;d<arguments.length;d++){var e=arguments[d];if(null!=e)for(var k in e)Object.prototype.hasOwnProperty.call(e,k)&&(c[k]=e[k])}return c},writable:!0,configurable:!0})})();p.exports=a},{"./ConfigLoader":9,"./logger":19}],19:[function(g,p,u){function n(c){var e=typeof c;if("string"===e)c=b[c];else if("number"===e)c=a[c];else return 3;return null==c?3:c.val}function q(a){var b=[],c;if(null==a)return b;if("object"===typeof a&&null==a.length)return b.push(a),b;for(c=0;c<a.length;c++){var e=
a[c];void 0!=e&&b.push(e)}return b}function l(){this.name="Logger";this.opts={level:"ERROR"};this.enabled=!0;var e=q(arguments),g=this,l=[],p=console;this.setConsoleObj=function(a){h(a.log)||(a.log=c);var b=f,d;for(d=0;d<b.length;d++)h(a[b[d]])||(a[b[d]]=a.log);b=r;for(d=0;d<b.length;d++)h(a[b[d]])||(a[b[d]]=c);p=a};(function(a){a=a||[];var b;if(0!=a.length)for(b=0;b<a.length;b++){var c=a[b];var d=typeof c;"string"===d?g.name=c:"object"==d&&(g.opts=c,null!=c.name&&(g.name=c.name),null==c.level&&(c.level=
"ERROR"),null!=c.console&&g.setConsoleObj(c.console))}})(e);this.getBuffer=function(){return l};this.group=function(){var a=q(arguments);p.group.apply(null,a)};this.groupEnd=function(){var a=q(arguments);p.groupEnd.apply(null,a)};this.log=function(){var c=q(arguments),e=!0;var f=b.LOG;if(2<=c.length)if("string"===typeof c[c.length-1]){f=c.pop();e=(e=b[f])&&e.val||0;var h=n(g.opts.level);e=e>=h;f=b[f]}else"number"===typeof c[c.length-1]&&(f=c.pop(),e=f>=n(g.opts.level),f=a[f]);f||(f=b.LOG);h=0==c.length?
this.name+": [no message]":"string"===typeof c[0]?this.name+": "+c.shift():this.name;c.unshift(h);((h=f.val==m.WARN||f.val==m.ERROR)||f.val==m.DEBUG)&&c.push({page:document.location.href});200<l.length&&l.shift();l.push(c);if(1==this.enabled&&e)return e=p,c=e[f.log]?e[f.log].apply(null,c):e.log.apply(null,c),h&&e.trace&&e.trace(),c}}var b={DEBUG:{val:0,log:"log"},INFO:{val:1,log:"log"},WARN:{val:2,log:"warn"},ERROR:{val:3,log:"error"},LOG:{val:99,log:"log"}},a=[b.DEBUG,b.INFO,b.WARN,b.ERROR,b.LOG],
f=["info","debug","warn","error"],r=["group","groupEnd","trace"],c=function(){},h=function(a){return"function"===typeof a};l.prototype.setLogLevel=function(b){var c=typeof b;if("string"===c)this.opts.level=b;else if("number"===c&&(b=a[b]))try{this.opts.level=b.log.toUpperCase()}catch(x){}};l.prototype.getLevels=function(){return b};l.prototype.debug=function(){var a=q(arguments);a.push(m.DEBUG);return this.log.apply(this,a)};l.prototype.info=function(){var a=q(arguments);a.push(m.INFO);return this.log.apply(this,
a)};l.prototype.warn=function(){var a=q(arguments);a.push(m.WARN);return this.log.apply(this,a)};l.prototype.error=function(){var a=q(arguments);a.push(m.ERROR);return this.log.apply(this,a)};var m={createLogger:function(a,b,c,f,d,g){return new l(a,b,c,f,d,g)},DEBUG:0,INFO:1,WARN:2,ERROR:3};p.exports=m},{}]},{},[8]);
