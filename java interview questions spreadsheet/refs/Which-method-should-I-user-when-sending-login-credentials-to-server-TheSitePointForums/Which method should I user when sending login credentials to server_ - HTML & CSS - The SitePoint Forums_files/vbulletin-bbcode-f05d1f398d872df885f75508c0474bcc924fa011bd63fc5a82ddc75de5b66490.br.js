define("discourse/plugins/discourse-bbcode/lib/discourse-markdown/bbcode",["exports","pretty-text/pretty-text"],function(t,e){"use strict";function a(t){for(;t!==(t=t.replace(/\[color=([^\]]+)\]((?:(?!\[color=[^\]]+\]|\[\/color\])[\S\s])*)\[\/color\]/gi,function(t,e,n){return"<font color='"+e+"'>"+n+"</font>"})););return t}function i(t){for(;t!==(t=t.replace(/\[size=([^\]]+)\]((?:(?!\[size=[^\]]+\]|\[\/size\])[\S\s])*)\[\/size\]/gi,function(t,e,n){return"<font size='"+e+"'>"+n+"</font>"})););return t}function c(t){for(;t!==(t=t.replace(/\[font=([^\]]+)\]((?:(?!\[font=[^\]]+\]|\[\/font\])[\S\s])*)\[\/font\]/gi,function(t,e,n){return"<font face='"+e+"'>"+n+"</font>"})););return t}function n(o,r,s){return function(t,e,n){t.tag=e.tag=o,t.content=e.content="",t.type="bbcode_open",e.type="bbcode_close",t.nesting=1,e.nesting=-1,t.attrs=[[r,s?s(n):n.attrs._default]]}}function l(t){var e=t.inline.bbcode.ruler;e.push("size",{tag:"size",wrap:n("font","size")}),e.push("font",{tag:"font",wrap:n("font","face")}),e.push("color",{tag:"color",wrap:n("font","color")}),e.push("bgcolor",{tag:"bgcolor",wrap:n("span","style",function(t){return"background-color:"+t.attrs._default.trim()})}),e.push("highlight",{tag:"highlight",wrap:"span.highlight"}),e.push("small",{tag:"small",wrap:n("span","style",function(){return"font-size:x-small"})}),e.push("aname",{tag:"aname",wrap:n("a","name")}),e.push("jumpto",{tag:"jumpto",wrap:n("a","href",function(t){return"#"+t.attrs._default})}),["left","right","center"].forEach(function(e){t.block.bbcode.ruler.push(e,{tag:e,wrap:function(t){return t.attrs=[["style","text-align:"+e]],!0}})}),t.block.bbcode.ruler.push("indent",{tag:"indent",wrap:"blockquote.indent"}),["ot","edit"].forEach(function(n){t.block.bbcode.ruler.push("ot",{tag:n,before:function(t){var e=t.push("sepquote_open","div",1);e.attrs=[["class","sepquote"]],(e=t.push("span_open","span",1)).block=!1,e.attrs=[["class","smallfont"]],(e=t.push("text","",0)).content=I18n.t("bbcode."+n),e=t.push("span_close","span",-1),t.push("soft_break","br",0),t.push("soft_break","br",0)},after:function(t){t.push("sepquote_close","div",-1)}})}),["list","ul","ol"].forEach(function(p){t.block.bbcode.ruler.push(p,{tag:p,replace:function(e,t,n){var o="ol"===p||"list"===p&&t.attrs._default,r=void 0;o?(r=e.push("ordered_list_open","ol",1),t.attrs._default&&(r.attrs=[["type",t.attrs._default]])):e.push("bullet_list_open","ul",1);for(var s=n.split("\n"),a=[null],i=0,c=0;c<s.length;c++){var l=s[c],u=l.match(/^\s*\[?\*\]?(.*)/);u?a[++i]=u[1]:(u=l.match(/\s*\[li\](.*)\[\/li\]\s*$/))?a[++i]=u[1]:a[i]?a[i]+="\n"+l:a[i]=l}return a.forEach(function(t){null!==t&&(e.push("list_item_open","li",1),(r=e.push("inline","",0)).content=t,r.children=[],e.push("list_item_close","li",-1))}),o?e.push("ordered_list_close","ol",-1):e.push("bullet_list_close","ul",-1),!0}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.setup=function(t){if(t.whiteList(["div.highlight","span.highlight","div.sepquote","span.smallfont","blockquote.indent","font[color=*]","font[size=*]","font[face=*]","ol[type=*]"]),t.whiteList({custom:function(t,e,n){return"span"===t&&"style"===e?/^(font-size:(xx-small|x-small|small|medium|large|x-large|xx-large)|background-color:#?[a-zA-Z0-9]+)$/.exec(n):"div"===t&&"style"===e?/^text-align:(center|left|right)$/.exec(n):void 0}}),t.markdownIt)return void t.registerPlugin(l);var e=(0,requirejs("pretty-text/engines/discourse-markdown/bbcode").builders)(t),n=e.register,o=e.replaceBBCode,r=e.rawBBCode,s=e.replaceBBCodeParamsRaw;o("small",function(t){return["span",{style:"font-size:x-small"}].concat(t)}),o("highlight",function(t){return["div",{class:"highlight"}].concat(t)}),["left","center","right"].forEach(function(e){o(e,function(t){return["div",{style:"text-align:"+e}].concat(t)})}),o("edit",function(t){return["div",{class:"sepquote"},["span",{class:"smallfont"},"Edit:"],["br"],["br"]].concat(t)}),o("ot",function(t){return["div",{class:"sepquote"},["span",{class:"smallfont"},"Off Topic:"],["br"],["br"]].concat(t)}),o("indent",function(t){return["blockquote",["div"].concat(t)]}),t.addPreProcessor(a),t.addPreProcessor(i),t.addPreProcessor(c),n("aname",function(t,e){return["a",{name:e,"data-bbcode":!0}].concat(t)}),n("jumpto",function(t,e){return["a",{href:"#"+e,"data-bbcode":!0}].concat(t)}),n("rule",function(t,e){return["div",{style:"margin: 6px 0; height: 0; border-top: 1px solid "+t+"; margin: auto; width: "+e}]}),r("noparse",function(t){return t}),r("fphp",function(t){return["a",{href:"http://www.php.net/manual-lookup.php?function="+t,"data-bbcode":!0},t]}),s("fphp",function(t,e){return["a",{href:"http://www.php.net/manual-lookup.php?function="+t,"data-bbcode":!0},e]}),r("google",function(t){return["a",{href:"http://www.google.com/search?q="+t,"data-bbcode":!0},t]}),t.replaceBlock({start:/\[list=?(\w)?\]([\s\S]*)/gim,stop:/\[\/list\]/gim,emitter:function(t,e){var n=this,o=e[1]?["ol",{type:e[1]}]:["ul"];return t.length&&t.forEach(function(t){t.split(/\n/).forEach(function(t){if(0===t.indexOf("[*]")){var e=n.processInline(t.slice(3));e&&o.push(["li"].concat(e))}})}),o}})},(0,e.registerOption)(function(t,e){return e.features["vbulletin-bbcode"]=!0})});
//# sourceMappingURL=https://sjc5.discourse-cdn.com/sitepoint/community/assets/plugins/vbulletin-bbcode-f05d1f398d872df885f75508c0474bcc924fa011bd63fc5a82ddc75de5b66490.js.map