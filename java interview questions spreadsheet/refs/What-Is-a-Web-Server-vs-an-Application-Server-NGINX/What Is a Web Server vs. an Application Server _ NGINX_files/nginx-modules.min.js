"use strict";var NX_COOKIES={setCookie:function(name,value,hours,path,domain,secure){path=path||"/";var expires="";if(hours!=null){var expire_time=new Date((new Date).getTime()+hours*36e5);expires="; expires="+expire_time.toGMTString()}document.cookie=encodeURIComponent(name)+"="+encodeURIComponent(value)+expires+(domain?"; domain="+domain:"")+(path?"; path="+path:"")+(secure?"; secure":"")},getCookie:function(name){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(name).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},deleteCookie:function(name,path,domain){path=path||"/";document.cookie=encodeURIComponent(name)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(domain?"; domain="+domain:"")+(path?"; path="+path:"")},hasItem:function(name){return new RegExp("(?:^|;\\s*)"+encodeURIComponent(name).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=").test(document.cookie)}};var NX_GDPR={consentGiven:false,clickedFormObj:null,formChecked:false,euCountries:[],euCountriesFileUrl:"/wp-content/themes/nginx-new/js/json-data/eu-codes.json",functionalCookieName:"nx_functional_cookie_consent",socialCookieName:"nx_social_cookie_consent",countryCode:"",canadaCode:"CA",usCode:"US",init:function($){this.loadEUCountries($).done(function(){this.countryCode=this.getCountryCode();this.setGlobals();$(function(){this.setupEvents($)}.bind(this));if(!this.consentGiven&&this.isEUCountry(this.countryCode)){window.onload=function(){NX_GDPR.showPopup()}}}.bind(this))},loadEUCountries:function($){var euCountries;if(sessionStorage.euCountries){euCountries=JSON.parse(sessionStorage.euCountries)}if(euCountries){this.euCountries=euCountries;return $.Deferred().resolve(euCountries)}else{return $.getJSON(this.euCountriesFileUrl).done(function(data){sessionStorage.euCountries=JSON.stringify(data);this.euCountries=data}.bind(this)).fail(function(){console.error("GDPR: could not load country file from "+this.euCountriesFileUrl)}.bind(this))}},setupEvents:function(){document.getElementById("gdpr-more-info").addEventListener("click",function(e){e.preventDefault();this.hideMain();this.showInfo()}.bind(this),false);document.getElementById("gdpr-less-info").addEventListener("click",function(e){e.preventDefault();this.showMain();this.hideInfo()}.bind(this));document.getElementById("nx_gdpr_accept_btn").addEventListener("click",function(){this.userAccept()}.bind(this))},hideMain:function(){this.hideElement("nx_gdpr_modal_main2")},showMain:function(){this.showElement("nx_gdpr_modal_main2")},showInfo:function(){this.showElement("nx_gdpr_modal_more_info2")},hideInfo:function(){this.hideElement("nx_gdpr_modal_more_info2")},setGlobals:function(){var fcc=NX_COOKIES.getCookie(this.functionalCookieName);var scc=NX_COOKIES.getCookie(this.socialCookieName);if(fcc||scc){this.consentGiven=true;if(fcc==="yes"){NX_GDPR_FUNCTIONAL_COOKIE_CONSENT="yes"}if(scc==="yes"){NX_GDPR_SOCIAL_COOKIE_CONSENT="yes"}}else if(!this.isEUCountry(this.countryCode)){NX_GDPR_FUNCTIONAL_COOKIE_CONSENT="yes";NX_GDPR_SOCIAL_COOKIE_CONSENT="yes"}},setConsent:function(type,value){switch(type){case"both":NX_COOKIES.setCookie(this.functionalCookieName,value,129600,"/");NX_COOKIES.setCookie(this.socialCookieName,value,129600,"/");this.updateFormSocialConsentField(value);this.updateFormFunctionalConsentField(value);break;case"social":NX_COOKIES.setCookie(this.socialCookieName,value,129600,"/");this.updateFormSocialConsentField(value);break;case"functional":NX_COOKIES.setCookie(this.functionalCookieName,value,129600,"/");this.updateFormFunctionalConsentField(value);break}this.setGlobals()},deleteConsent:function(type){switch(type){case"both":NX_COOKIES.deleteCookie(this.functionalCookieName);NX_COOKIES.deleteCookie(this.socialCookieName);break;case"functional":NX_COOKIES.deleteCookie(this.functionalCookieName);break;case"social":NX_COOKIES.deleteCookie(this.socialCookieName);break}},userAccept:function(){if(document.getElementById("nx_gdpr_social_con_checkbox").checked){this.setConsent("both","yes")}else{this.setConsent("social","no");this.setConsent("functional","yes")}if(this.clickedFormObj!==null){this.setGlobals();var _form=this.clickedFormObj;this.formChecked=true;var submit_button=_form.find(".mktf_submit_button").first();submit_button.trigger("click");this.hidePopup()}else{document.getElementById("nx_gdpr_accept_btn").disabled=true;location.reload()}},updateFormSocialConsentField:function(value){if(this.clickedFormObj!==null){var _form=this.clickedFormObj;_form.find(".mktf_Cookie_Opt_In__c").first().val(value)}},updateFormFunctionalConsentField:function(value){if(this.clickedFormObj!==null){var _form=this.clickedFormObj;_form.find(".mktf_Functional_Cookie_Opt_In__c").first().val(value)}},verifyAcceptance:function(countryCode,_form){var allow_submission=false;if(this.formChecked||countryCode===""){allow_submission=true}else{if(this.isEUCountry(countryCode)&&!this.consentGiven){this.clickedFormObj=_form;this.showPopup();this.animatePopup();allow_submission=false}else{allow_submission=true}}return allow_submission},showPopup:function(){var scc=NX_COOKIES.getCookie(this.socialCookieName);if(scc==="no"){document.getElementById("nx_gdpr_social_con_checkbox").checked=false}this.showElement("nx_gdpr_modal2")},hidePopup:function(){this.hideElement("nx_gdpr_modal2")},animatePopup:function(){var elm=document.getElementById("nx_gdpr_modal2");elm.classList.add("animate");setTimeout(function(){elm.classList.remove("animate")},1e3)},showElement:function(id){var elm=document.getElementById(id);elm.classList.remove("hidden")},hideElement:function(id){var elm=document.getElementById(id);elm.classList.add("hidden")},isEUCountry:function(countryCode){if(!countryCode){countryCode=this.countryCode}return this.euCountries.indexOf(countryCode)>-1},isCanada:function(countryCode){if(!countryCode){countryCode=this.countryCode}return countryCode===this.canadaCode},isUS:function(countryCode){if(!countryCode){countryCode=this.countryCode}return countryCode===this.usCode},getCountryCode:function(){var countryCode="";var geoLocation=NX_COOKIES.getCookie("geoip");if(geoLocation){var geoCodes=geoLocation.split(",");countryCode=geoCodes[0]}return countryCode}};NX_GDPR.init(jQuery);var NX_FORM_AUTOFILL;var NX_MARKETO_FORM;(function($){NX_MARKETO_FORM={init:function(){this.validation_and_submit_handler();this.addEvents();this.configure_select2();this.update_cookie_consent_fields();this.show_email_opt_in_field()},addEvents:function(){},validation_and_submit_handler:function(){$(".mktf_submit_button").click(function(e){NX_GDPR.setGlobals();e.preventDefault();var submit_button=$(this);var _form=$(this).closest("form");var _body=$(this).closest("body");var form_id=_form.attr("id");var Form_Has_Error=false;if(!NX_MARKETO_FORM.check_honeypot(_form)){return false}_form.find(".required").each(function(){if(Form_Has_Error){return}var name=$(this).attr("name");var is_valid=true;var target=$(this);var msg="";var element_type=NX_MARKETO_FORM.get_element_type(this);switch(element_type){case"text":{var value=$.trim($(this).val());if(value===""){is_valid=false;msg="This field is required."}else{if(name==="Email"){is_valid=NX_MARKETO_FORM.is_valid_email(value);if(!is_valid){msg="Please provide a correct email address."}else if(target.hasClass("mktf_Business_Email")&&nx_is_fee_email(value)){is_valid=false;msg="Please provide your business email address."}}else if(name==="Phone"){is_valid=nx_is_valid_phone_number(value);if(!is_valid){msg="Please provide a correct phone number"}}}break}case"select":{var selectedIndex=this.selectedIndex;if(selectedIndex<1){is_valid=false;msg="Select a value."}break}case"checkbox":{var checked=$(this).prop("checked");if(!checked){is_valid=false;msg="This field is required."}break}case"textarea":{var value=$.trim($(this).val());if(value===""){is_valid=false;msg="This field is required."}break}case"radio":{var len=$("[name='"+name+"']:checked").length;if(len===0){is_valid=false;msg="This field is required."}}}if(!is_valid){Form_Has_Error=true;NX_MARKETO_FORM.show_error_msg(_form,target,msg);return false}});if(!Form_Has_Error){if(!NX_MARKETO_FORM.check_email_opt_in_field(_form)){Form_Has_Error=true;var msg="Required";var target=_form.find(".mktf_Explicit_Opt_In__c").first();NX_MARKETO_FORM.show_error_msg(_form,target,msg,opt);return false}}if(!Form_Has_Error&&!nginxThemeVars.NGINX_IS_LOCAL_SITE){if(_form.hasClass("enable_recaptcha")){if($("#"+form_id+"_recaptcha_result").val()!=="1"){Form_Has_Error=true;var msg="Prove you are not a robot";var target=$("#"+form_id+"_recaptcha");var opt={TopExtra:60,LeftExtra:9};Form_Has_Error=true;NX_MARKETO_FORM.show_error_msg(_form,target,msg,opt);return false}}}if(!Form_Has_Error){if(!NX_MARKETO_FORM.validate_GDPR_consent(_form)){return false}_form.attr("action",nginxThemeVars.marketFormEndPoint);NX_MARKETO_FORM.add_loader_and_disable_button(submit_button);$(document).trigger("nx_marketo_form:before_submit",[_form]);$(document).trigger("nx_marketo_form:"+form_id+":before_submit",[_form]);var ebook_result=$.Deferred();if(_body.hasClass("info-type_library")){ebook_result=NX_MARKETO_EBOOK.submitEbook($,nginxThemeVars.postid,_form)}else{ebook_result.resolve()}var slack_result=$.Deferred();if(_form.hasClass("slack_enabled")){slack_result=NX_SLACK.postToSlack(_form)}else{slack_result.resolve()}$.when(ebook_result,slack_result).then(function(){_form.submit()},function(error){console.error("failure: "+error);_form.submit()});return false}else{return false}});$(".nx_marketo_form").on("keyup","input, textarea",function(){$(".mktf_err_msg").remove()});$(".nx_marketo_form").on("change","select",function(){$(".mktf_err_msg").remove()});$(".nx_marketo_form").on("change",".mktf_Country",function(){var _form=$(this).closest("form");_form.find(".mktf_UsaStateSelect").parent().hide();_form.find(".mktf_CanadaProvinceSelect").parent().hide();var country_value=$(this).val();if(NX_GDPR.isUS(country_value)||NX_GDPR.isCanada(country_value)){_form.find(".mktf_State").hide();if(NX_GDPR.isCanada(country_value)){_form.find(".mktf_UsaStateSelect").parent().show()}else{_form.find(".mktf_CanadaProvinceSelect").parent().show()}}else{_form.find(".mktf_State").val("");_form.find(".mktf_State").show()}if(_form.find(".mktf_Explicit_Opt_In__c_wrap").length){if(NX_GDPR.isEUCountry(country_value)||NX_GDPR.isCanada(country_value)){NX_GDPR.setGlobals();_form.find(".mktf_Explicit_Opt_In__c_wrap").first().show();_form.find(".mktf_Functional_Cookie_Opt_In__c").first().attr("name","Functional_Cookie_Opt_In__c");_form.find(".mktf_Functional_Cookie_Opt_In__c").first().val(NX_GDPR_FUNCTIONAL_COOKIE_CONSENT);_form.find(".mktf_Cookie_Opt_In__c").first().attr("name","Cookie_Opt_In__c");_form.find(".mktf_Cookie_Opt_In__c").first().val(NX_GDPR_SOCIAL_COOKIE_CONSENT)}else{if(!NX_GDPR.isEUCountry()&&!NX_GDPR.isCanada()){_form.find(".mktf_Explicit_Opt_In__c_wrap").first().hide()}}}});var instance_field=$(".mktf_num_of_instances");if(instance_field.length){$(".mktf_Expected_of_Plus_instances_for_the_con__c").val(instance_field[0].value)}$(".nx_marketo_form").on("change",".mktf_num_of_instances",function(e){$(".mktf_Expected_of_Plus_instances_for_the_con__c").val(this.value)});$(".nx_marketo_form").on("change",".mktf_UsaStateSelect, .mktf_CanadaProvinceSelect",function(){var _form=$(this).closest("form");var idx=this.selectedIndex;if(idx===0){var value=""}else{var value=$(this).val()}_form.find(".mktf_State").val(value)})},show_error_msg:function(_form,target,msg,opt){opt=typeof opt==="undefined"?{}:opt;var TOP=0;var LEFT=0;var TopExtra=typeof opt.TopExtra!=="undefined"?opt.TopExtra:35;var LeftExtra=typeof opt.LeftExtra!=="undefined"?opt.LeftExtra:-6;var theme=_form.attr("err_msg_theme");var error_msg_html_start='<div class="mktf_err_msg '+theme+'" style="margin-left: LEFT; margin-top: TOP"><div class="top_arrow"></div>';var error_msg_html_end="<div>";var errMSG=error_msg_html_start+msg+error_msg_html_end;TOP=target.offset().top-target.parent().offset().top-target.parent().scrollTop()+TopExtra;LEFT=target.offset().left-target.parent().offset().left+LeftExtra;errMSG=errMSG.replace("TOP",TOP+"px");errMSG=errMSG.replace("LEFT",LEFT+"px");$(".mktf_err_msg").remove();target.parent().prepend(errMSG)},is_valid_email:function(value){var regex=/^([a-zA-Z0-9_.+-])+@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;return regex.test(value)},get_element_type:function(obj){var tag=obj.tagName;tag=tag.toLowerCase();var type=obj.type;var el_type="text";if(tag==="INPUT"){if(type==="checkbox"){return"checkbox"}if(type==="radio"){return"radio"}if(type==="text"){return"text"}if(type==="email"){return"text"}if(type==="tel"){return"text"}if(type==="hidden"){return"hidden"}if(type==="submit"){return"submit"}}else if(tag==="SELECT"){return"select"}else if(tag==="TEXTAREA"){return"textarea"}return el_type},get_fields_value:function(_form,fields_group){fields_group=fields_group||"all";fields_group=fields_group!=="all"&&fields_group!=="user_inputed"&&fields_group!=="required"?"all":fields_group;var DATA={};if(fields_group===""){var selector="mktf_field"}else{var selector="."+fields_group}_form.child(selector).each(function(){var name=$(this).attr("name");var value=NX_MARKETO_FORM.get_field_value($(this));DATA[name]=value});return DATA},get_field_value:function(field_obj){var value=null;var element_type=NX_MARKETO_FORM.get_element_type(this);switch(element_type){case"text":{value=$.trim(field_obj.val());break}case"select":{value=field_obj.val();break}case"checkbox":{value=field_obj.is(":checked");break}case"textarea":{value=$.trim(field_obj.val());break}}return value},add_loader_and_disable_button:function(button){$(button).attr("disabled","disabled");$(button).addClass("loading")},check_honeypot:function(_form){if(!_form.hasClass("enable_honeypot")){return true}var honeypot=_form.find(".mktf_honeypot").first();if(honeypot.length){if(honeypot.val()!==""){var return_url=_form.find("input[name='returnURL']").first().val();window.location.href=return_url;return false}else{return true}}else{return true}},renderRecaptcha:function(){$(".nx_marketo_form.enable_recaptcha").each(function(){var _form=$(this);var form_id=$(this).attr("id");$(_form).find(".mktf_submit_button").removeAttr("disabled");grecaptcha.render(form_id+"_recaptcha",{sitekey:nginxThemeVars.gSiteKey,callback:function(response){$("#"+form_id+"_recaptcha_response").val(response);$("#"+form_id+"_recaptcha_result").val(1);$(".mktf_err_msg").remove()},"expired-callback":function(){$("#"+form_id+"_recaptcha_response").val("");$("#"+form_id+"_recaptcha_result").val(0);$(".mktf_err_msg").remove()}})})},configure_select2:function(){$(".mktf_cloudAccountName").each(function(){$(this).select2({placeholder:$(this).attr("placeholder"),width:"100%",allowClear:true,dropdownCssClass:"mktf_dropdown",containerCssClass:"mktf_dropdown"})});$(".mktf_select2").each(function(){$(this).select2({placeholder:$(this).attr("placeholder"),width:"100%",allowClear:true,dropdownCssClass:"mktf_dropdown",containerCssClass:"mktf_dropdown"})})},update_cookie_consent_fields:function(){if(NX_GDPR.isEUCountry()||NX_GDPR.isCanada()||typeof NX_GDPR!=="undefined"&&NX_GDPR.consentGiven){NX_GDPR.setGlobals();if(typeof NX_GDPR_FUNCTIONAL_COOKIE_CONSENT!="undefined"){$(".mktf_Functional_Cookie_Opt_In__c").attr("name","Functional_Cookie_Opt_In__c");$(".mktf_Functional_Cookie_Opt_In__c").val(NX_GDPR_FUNCTIONAL_COOKIE_CONSENT)}if(typeof NX_GDPR_SOCIAL_COOKIE_CONSENT!="undefined"){$(".mktf_Cookie_Opt_In__c").attr("name","Cookie_Opt_In__c");$(".mktf_Cookie_Opt_In__c").val(NX_GDPR_SOCIAL_COOKIE_CONSENT)}}else{$(".mktf_Cookie_Opt_In__c").removeAttr("name");$(".mktf_Functional_Cookie_Opt_In__c").removeAttr("name")}},show_email_opt_in_field:function(){if(NX_GDPR.isEUCountry()||NX_GDPR.isCanada()){$(".mktf_Explicit_Opt_In__c_wrap").show()}},check_email_opt_in_field:function(_form){var selected_country_code=this.get_selected_country_code(_form);if(NX_GDPR.isEUCountry()||NX_GDPR.isCanada()||NX_GDPR.isCanada(selected_country_code)||selected_country_code!==""&&NX_GDPR.isEUCountry(selected_country_code)){if(_form.find(".mktf_Explicit_Opt_In__c").length){var elm=_form.find(".mktf_Explicit_Opt_In__c").first();return elm.is(":checked")}else{console.error("Error: Explicit opt-in field not found");return false}}else{return true}},get_selected_country_code:function(_form){var country_code="";if(_form.find(".mktf_Country").length){var elm=_form.find(".mktf_Country").first();country_code=$(elm).val()}return country_code},validate_GDPR_consent:function(_form){if(_form.find(".mktf_Country").length){var elm=_form.find(".mktf_Country").first();var country_code=$(elm).val();return NX_GDPR.verifyAcceptance(country_code,_form)}return true}};NX_FORM_AUTOFILL={dataCookieName:"_nx_form_autofill_data",prevData:{},hasPrevData:false,init:function(){this.retrievePreviousData();this.autoFillForms();$("form.nx_enable_auto_fill").on("change","select , input[type=text], input[type=email], input[type=tel]",function(){var fieldName=$(this).attr("name");var val=$(this).val();NX_FORM_AUTOFILL.saveFieldData(fieldName,val)});$(document).trigger("nx_form_autofill_complete")},autoFillForms:function(){$("form.nx_enable_auto_fill input[type=text], form.nx_enable_auto_fill input[type=email], form.nx_enable_auto_fill input[type=tel]").each(function(){var fieldName=$(this).attr("name");var oldVal=NX_FORM_AUTOFILL.getPreviousData(fieldName);if(oldVal!=""){$(this).val(oldVal)}});$("form.nx_enable_auto_fill select").each(function(){var fieldName=$(this).attr("name");var oldVal=NX_FORM_AUTOFILL.getPreviousData(fieldName);if(oldVal!==""){if($(this).hasClass("select2-hidden-accessible")){$(this).select2("val",oldVal)}else{$(this).val(oldVal)}}})},retrievePreviousData:function(){var json_str=NX_COOKIES.getCookie(this.dataCookieName)||"";if(json_str!==""){this.prevData=JSON.parse(json_str);this.hasPrevData=true}},getPreviousData:function(fieldName){var val=this.prevData[fieldName];return val!=undefined?val:""},saveFieldData:function(fieldName,val){this.prevData[fieldName]=val;var str=JSON.stringify(this.prevData);NX_COOKIES.setCookie(this.dataCookieName,str,2160,"/")}};$(document).ready(function(){NX_MARKETO_FORM.init();NX_FORM_AUTOFILL.init()})})(jQuery);"use strict";var NX_MARKETO_EBOOK={submitEbook:function($,postid,form){var data={};var deferred=$.Deferred();var first_name=form.find("input[name=FirstName]").val();var to=form.find("input[name=Email]").val();data.action="mail_ebook";data._wpnonce=nginxThemeVars.ebook_nonce;data.postid=postid;data.first_name=first_name;data.to=to;var serialized_data=$.param(data);$.post(nginxThemeVars.ajaxurl,serialized_data,function(response){if(response.success){deferred.resolve()}else{deferred.reject(response.error)}});return deferred}};"use strict";var NX_SLACK={getLabel:function(el){var label="";if(typeof el.placeholder!=="undefined"&&el.placeholder!==""){label=el.placeholder;if(label.slice(-2)===" *"){label=label.slice(0,-2)}}else if(typeof el.attributes.placeholder!=="undefined"&&el.attributes.placeholder.value!==""){label=el.attributes.placeholder.value;if(label.slice(-2)===" *"){label=label.slice(0,-2)}}else if(typeof el.labels!=="undefined"&&el.labels.length>0){label=el.labels[0].innerHTML}else{label=el.value}return label},getElementValue:function(el){var element=false;var label="";switch(el.type){case"hidden":if(el.name==="slackEnabled"){element={name:"slackEnabled",value:true}}else if(el.name==="slackChannel"){element={name:"slackChannel",value:el.value}}else if(el.name==="contentsubmissionURL"){element={name:"URL",value:el.value}}break;case"checkbox":if(el.checked){label=this.getLabel(el);element={};element.name=label;element.value=el.value}break;case"radio":label=this.getLabel(el);element={};element.name=label;element.value=jQuery("[name='"+el.name+"']:checked").val();break;case"text":case"email":case"tel":case"textarea":label=this.getLabel(el);element={};element.name=label;element.value=el.value;break;case"select-one":label=this.getLabel(el);element={};element.name=label;element.value=el.options[el.selectedIndex].text}return element},collectFormData:function(_form){var data={};_form.find(".mktf_field").each(function(idx,el){var element=this.getElementValue(el);if(element){data[element.name]=element.value}}.bind(this));return data},submitToSlack:function($,data){var deferred=$.Deferred();if(data.slackEnabled===true){delete data.slackEnabled;data.action="post_to_slack";data._wpnonce=nginxThemeVars.slack_nonce;var serialized_data=$.param(data);$.post(nginxThemeVars.ajaxurl,serialized_data,function(response){if(response.success){deferred.resolve()}else{deferred.reject(response.error)}})}return deferred},postToSlack:function(_form){var data=this.collectFormData(_form);return this.submitToSlack(jQuery,data)}};
//# sourceMappingURL=nginx-modules.min.js.map
