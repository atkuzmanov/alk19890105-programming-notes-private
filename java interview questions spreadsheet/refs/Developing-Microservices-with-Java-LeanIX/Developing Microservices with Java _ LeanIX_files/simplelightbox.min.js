(function(c,b,a,d){c.fn.simpleLightbox=function(A){var A=c.extend({sourceAttr:"href",overlay:true,spinner:true,nav:true,navText:["&lsaquo;","&rsaquo;"],captions:true,captionDelay:0,captionSelector:"img",captionType:"attr",captionsData:"title",captionPosition:"bottom",captionClass:"",close:true,closeText:"Ã—",swipeClose:true,showCounter:true,fileExt:"png|jpg|jpeg|gif",animationSlide:true,animationSpeed:250,preloading:true,enableKeyboard:true,loop:true,rel:false,docClose:true,swipeTolerance:50,className:"simple-lightbox",widthRatio:0.8,heightRatio:0.9,scaleImageToRatio:false,disableRightClick:false,disableScroll:true,alertError:true,alertErrorMessage:"Image not found, next image will be loaded",additionalHtml:false,history:true},A);var T=("ontouchstart" in b),p=b.navigator.pointerEnabled||b.navigator.msPointerEnabled,k=function(Y){if(T){return true}if(!p||typeof Y==="undefined"||typeof Y.pointerType==="undefined"){return false}if(typeof Y.MSPOINTER_TYPE_MOUSE!=="undefined"){if(Y.MSPOINTER_TYPE_MOUSE!=Y.pointerType){return true}}else{if(Y.pointerType!="mouse"){return true}}return false},j=0,n=0,L=c(),K=function(){var Y=a.body||a.documentElement;Y=Y.style;if(Y.WebkitTransition===""){return"-webkit-"}if(Y.MozTransition===""){return"-moz-"}if(Y.OTransition===""){return"-o-"}if(Y.transition===""){return""}return false},t=false,B=[],E=function(Y,Z){var aa=Z.filter(function(){return(c(this).attr("rel")===Y)});return aa},N=(A.rel&&A.rel!==false)?E(A.rel,c(this)):this,K=K(),f=0,Q=(K!==false)?true:false,X=("pushState" in history),s=false,q,M=b.location,r=function(){return M.hash.substring(1)},V=r(),W=function(){var Z=r(),Y="pid="+(C+1);var aa=M.href.split("#")[0]+"#"+Y;if(X){history[s?"replaceState":"pushState"]("",a.title,aa)}else{if(s){M.replace(aa)}else{M.hash=Y}}s=true},P=function(){if(X){history.pushState("",a.title,M.pathname+M.search)}else{M.hash=""}clearTimeout(q)},o=function(){if(!s){W()}else{q=setTimeout(W,800)}},H="simplelb",R=c("<div>").addClass("sl-overlay"),G=c("<button>").addClass("sl-close").html(A.closeText),D=c("<div>").addClass("sl-spinner").html("<div></div>"),v=c("<div>").addClass("sl-navigation").html('<button class="sl-prev">'+A.navText[0]+'</button><button class="sl-next">'+A.navText[1]+"</button>"),g=c("<div>").addClass("sl-counter").html('<span class="sl-current"></span>/<span class="sl-total"></span>'),w=false,C=0,J=c("<div>").addClass("sl-caption "+A.captionClass+" pos-"+A.captionPosition),i=c("<div>").addClass("sl-image"),y=c("<div>").addClass("sl-wrapper").addClass(A.className),h=function(aa){if(!A.fileExt){return true}var Z=/\.([0-9a-z]+)(?=[?#])|(\.)(?:[\w]+)$/gmi;var Y=c(aa).attr(A.sourceAttr).match(Z);return Y&&c(aa).prop("tagName").toLowerCase()=="a"&&(new RegExp(".("+A.fileExt+")$","i")).test(Y)},l=function(){if(A.close){G.appendTo(y)}if(A.showCounter){if(N.length>1){g.appendTo(y);g.find(".sl-total").text(N.length)}}if(A.nav){v.appendTo(y)}if(A.spinner){D.appendTo(y)}},U=function(Y){Y.trigger(c.Event("show.simplelightbox"));if(A.disableScroll){f=I("hide")}y.appendTo("body");i.appendTo(y);if(A.overlay){R.appendTo(c("body"))}w=true;C=N.index(Y);L=c("<img/>").hide().attr("src",Y.attr(A.sourceAttr));if(B.indexOf(Y.attr(A.sourceAttr))==-1){B.push(Y.attr(A.sourceAttr))}i.html("").attr("style","");L.appendTo(i);u();R.fadeIn("fast");c(".sl-close").fadeIn("fast");D.show();v.fadeIn("fast");c(".sl-wrapper .sl-counter .sl-current").text(C+1);g.fadeIn("fast");z();if(A.preloading){m()}setTimeout(function(){Y.trigger(c.Event("shown.simplelightbox"))},A.animationSpeed)},z=function(Z){if(!L.length){return}var Y=new Image(),aa=c(b).width()*A.widthRatio,ab=c(b).height()*A.heightRatio;Y.src=L.attr("src");c(Y).on("error",function(ac){N.eq(C).trigger(c.Event("error.simplelightbox"));w=false;t=true;D.hide();if(A.alertError){alert(A.alertErrorMessage)}if(Z==1||Z==-1){x(Z)}else{x(1)}return});Y.onload=function(){if(typeof Z!=="undefined"){N.eq(C).trigger(c.Event("changed.simplelightbox")).trigger(c.Event((Z===1?"nextDone":"prevDone")+".simplelightbox"))}if(A.history){o()}if(B.indexOf(L.attr("src"))==-1){B.push(L.attr("src"))}var ad=Y.width,ac=Y.height;if(A.scaleImageToRatio||ad>aa||ac>ab){var ag=ad/ac>aa/ab?ad/aa:ac/ab;ad/=ag;ac/=ag}c(".sl-image").css({top:(c(b).height()-ac)/2+"px",left:(c(b).width()-ad-f)/2+"px"});D.hide();L.css({width:ad+"px",height:ac+"px"}).fadeIn("fast");t=true;var ae=(A.captionSelector=="self")?N.eq(C):N.eq(C).find(A.captionSelector);var ah;if(A.captionType=="data"){ah=ae.data(A.captionsData)}else{if(A.captionType=="text"){ah=ae.html()}else{ah=ae.prop(A.captionsData)}}if(!A.loop){if(C===0){c(".sl-prev").hide()}if(C>=N.length-1){c(".sl-next").hide()}if(C>0){c(".sl-prev").show()}if(C<N.length-1){c(".sl-next").show()}}if(N.length==1){c(".sl-prev, .sl-next").hide()}if(Z==1||Z==-1){var af={opacity:1};if(A.animationSlide){if(Q){e(0,100*Z+"px");setTimeout(function(){e(A.animationSpeed/1000,0+"px")},50)}else{af.left=parseInt(c(".sl-image").css("left"))+100*Z+"px"}}c(".sl-image").animate(af,A.animationSpeed,function(){w=false;F(ah)})}else{w=false;F(ah)}if(A.additionalHtml&&c(".sl-additional-html").length===0){c("<div>").html(A.additionalHtml).addClass("sl-additional-html").appendTo(c(".sl-image"))}}},F=function(Y){if(Y!==""&&typeof Y!=="undefined"&&A.captions){J.html(Y).hide().appendTo(c(".sl-image")).delay(A.captionDelay).fadeIn("fast")}},e=function(Z,aa){var Y={};Y[K+"transform"]="translateX("+aa+")";Y[K+"transition"]=K+"transform "+Z+"s linear";c(".sl-image").css(Y)},u=function(){c(b).on("resize."+H,z);c(a).on("click."+H+" touchstart."+H,".sl-close",function(ae){ae.preventDefault();if(t){O()}});if(A.history){setTimeout(function(){c(b).on("hashchange."+H,function(){if(t){if(r()===V){O();return}}})},40)}v.on("click."+H,"button",function(ae){ae.preventDefault();j=0;x(c(this).hasClass("sl-next")?1:-1)});var ad=0,ab=0,ac=0,aa=0,Z=false,Y=0;i.on("touchstart."+H+" mousedown."+H,function(ae){if(Z){return true}if(Q){Y=parseInt(i.css("left"))}Z=true;j=0;n=0;ad=ae.originalEvent.pageX||ae.originalEvent.touches[0].pageX;ac=ae.originalEvent.pageY||ae.originalEvent.touches[0].pageY;return false}).on("touchmove."+H+" mousemove."+H+" pointermove MSPointerMove",function(ae){if(!Z){return true}ae.preventDefault();ab=ae.originalEvent.pageX||ae.originalEvent.touches[0].pageX;aa=ae.originalEvent.pageY||ae.originalEvent.touches[0].pageY;j=ad-ab;n=ac-aa;if(A.animationSlide){if(Q){e(0,-j+"px")}else{i.css("left",Y-j+"px")}}}).on("touchend."+H+" mouseup."+H+" touchcancel."+H+" mouseleave."+H+" pointerup pointercancel MSPointerUp MSPointerCancel",function(af){if(Z){Z=false;var ae=true;if(!A.loop){if(C===0&&j<0){ae=false}if(C>=N.length-1&&j>0){ae=false}}if(Math.abs(j)>A.swipeTolerance&&ae){x(j>0?1:-1)}else{if(A.animationSlide){if(Q){e(A.animationSpeed/1000,0+"px")}else{i.animate({left:Y+"px"},A.animationSpeed/2)}}}if(A.swipeClose&&Math.abs(n)>50&&Math.abs(j)<A.swipeTolerance){O()}}})},S=function(){v.off("click","button");c(a).off("click."+H,".sl-close");c(b).off("resize."+H);c(b).off("hashchange."+H)},m=function(){var Y=(C+1<0)?N.length-1:(C+1>=N.length-1)?0:C+1,Z=(C-1<0)?N.length-1:(C-1>=N.length-1)?0:C-1;c("<img />").attr("src",N.eq(Y).attr(A.sourceAttr)).on("load",function(){if(B.indexOf(c(this).attr("src"))==-1){B.push(c(this).attr("src"))}N.eq(C).trigger(c.Event("nextImageLoaded.simplelightbox"))});c("<img />").attr("src",N.eq(Z).attr(A.sourceAttr)).on("load",function(){if(B.indexOf(c(this).attr("src"))==-1){B.push(c(this).attr("src"))}N.eq(C).trigger(c.Event("prevImageLoaded.simplelightbox"))})},x=function(Y){N.eq(C).trigger(c.Event("change.simplelightbox")).trigger(c.Event((Y===1?"next":"prev")+".simplelightbox"));var aa=C+Y;if(w||(aa<0||aa>=N.length)&&A.loop===false){return}C=(aa<0)?N.length-1:(aa>N.length-1)?0:aa;c(".sl-wrapper .sl-counter .sl-current").text(C+1);var Z={opacity:0};if(A.animationSlide){if(Q){e(A.animationSpeed/1000,(-100*Y)-j+"px")}else{Z.left=parseInt(c(".sl-image").css("left"))+-100*Y+"px"}}c(".sl-image").animate(Z,A.animationSpeed,function(){setTimeout(function(){var ab=N.eq(C);L.attr("src",ab.attr(A.sourceAttr));if(B.indexOf(ab.attr(A.sourceAttr))==-1){D.show()}c(".sl-caption").remove();z(Y);if(A.preloading){m()}},100)})},O=function(){if(w){return}var Z=N.eq(C),Y=false;Z.trigger(c.Event("close.simplelightbox"));if(A.history){P()}c(".sl-image img, .sl-overlay, .sl-close, .sl-navigation, .sl-image .sl-caption, .sl-counter").fadeOut("fast",function(){if(A.disableScroll){I("show")}c(".sl-wrapper, .sl-overlay").remove();S();if(!Y){Z.trigger(c.Event("closed.simplelightbox"))}Y=true});L=c();t=false;w=false},I=function(Y){var Z=0;if(Y=="hide"){var ad=b.innerWidth;if(!ad){var ab=a.documentElement.getBoundingClientRect();ad=ab.right-Math.abs(ab.left)}if(a.body.clientWidth<ad){var ac=a.createElement("div"),aa=parseInt(c("body").css("padding-right"),10);ac.className="sl-scrollbar-measure";c("body").append(ac);Z=ac.offsetWidth-ac.clientWidth;c(a.body)[0].removeChild(ac);c("body").data("padding",aa);if(Z>0){c("body").addClass("hidden-scroll").css({"padding-right":aa+Z})}}}else{c("body").removeClass("hidden-scroll").css({"padding-right":c("body").data("padding")})}return Z};l();N.on("click."+H,function(Y){if(h(this)){Y.preventDefault();if(w){return false}U(c(this))}});c(a).on("click."+H+" touchstart."+H,function(Y){if(t){if((A.docClose&&c(Y.target).closest(".sl-image").length===0&&c(Y.target).closest(".sl-navigation").length===0)){O()}}});if(A.disableRightClick){c(a).on("contextmenu",".sl-image img",function(Y){return false})}if(A.enableKeyboard){c(a).on("keyup."+H,function(Z){j=0;if(t){Z.preventDefault();var Y=Z.keyCode;if(Y==27){O()}if(Y==37||Z.keyCode==39){x(Z.keyCode==39?1:-1)}}})}this.open=function(Y){Y=Y||c(this[0]);U(Y)};this.next=function(){x(1)};this.prev=function(){x(-1)};this.close=function(){O()};this.destroy=function(){c(a).off("click."+H).off("keyup."+H);O();c(".sl-overlay, .sl-wrapper").remove();this.off("click")};this.refresh=function(){this.destroy();c(this).simpleLightbox(A)};return this}})(jQuery,window,document);